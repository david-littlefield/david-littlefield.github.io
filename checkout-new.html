<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>STÅŒR</title>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
      /* ===== Theme Variables ===== */
      :root {
        /* Colors - Core Palette */
        --color-canvas: #fffcf9;
        --color-surface: #fff9f4;
        --color-surface-raised: #fff7f1;
        --color-background: #f5f0eb;
        --color-background-subtle: #f9f5f1;
        --color-white: #ffffff;

        /* Colors - Text Hierarchy */
        --color-text-primary: #4d3f33;
        --color-text-secondary: #937b65;
        --color-text-tertiary: #a89d94;
        --color-text-whisper: #c4b5a8;
        --color-text-ghost: #d9cfc6;
        --color-text-inverse: #fffcf9;

        /* Colors - Accent */
        --color-accent-primary: #b38b6d;
        --color-accent-secondary: #c4a27a;
        --color-accent-nude: #e6d4c6;
        --color-accent-blush: #e8d5cc;
        --color-accent-clay: #d4b8a0;
        --color-accent-sand: #f0e6dd;

        /* Colors - Interactive States */
        --color-interactive-hover: #a67d5f;
        --color-interactive-pressed: #967052;

        /* Colors - Borders */
        --color-border-invisible: rgba(196, 162, 122, 0.04);
        --color-border-light: rgba(196, 162, 122, 0.08);
        --color-border-medium: rgba(196, 162, 122, 0.15);
        --color-border-strong: rgba(196, 162, 122, 0.25);
        --color-border-focused: rgba(179, 139, 109, 0.4);

        /* Colors - Overlays */
        --color-overlay-subtle: rgba(196, 162, 122, 0.03);
        --color-overlay-light: rgba(196, 162, 122, 0.06);
        --color-overlay-medium: rgba(196, 162, 122, 0.1);
        --color-overlay-heavy: rgba(77, 63, 51, 0.4);
        --color-overlay-pressed: rgba(179, 139, 109, 0.15);

        /* Colors - Semantic */
        --color-semantic-error: #c67b5c;
        --color-semantic-success: #8fa67a;

        /* Spacing Scale (8px base) */
        --space-1: 4px;
        --space-2: 8px;
        --space-3: 12px;
        --space-4: 16px;
        --space-5: 20px;
        --space-6: 24px;
        --space-8: 32px;
        --space-12: 48px;

        /* Spacing - Semantic Aliases */
        --space-micro: var(--space-1);
        --space-tiny: var(--space-2);
        --space-small: var(--space-3);
        --space-base: var(--space-4);
        --space-medium: var(--space-5);
        --space-large: var(--space-6);
        --space-gutter: var(--space-6);
        --space-xlarge: var(--space-8);
        --space-xxlarge: var(--space-12);

        /* Heights */
        --height-header: 60px;
        --height-input: 52px;
        --height-button: 52px;
        --height-pill: 40px;
        --height-icon-button: 48px;
        --height-modal-header: 60px;
        --height-modal-footer: 60px;
        --height-list-item-compact: 48px;
        --height-dot-medium: 6px;

        /* Icon Sizes */
        --icon-size-small: 16px;
        --icon-size-default: 20px;
        --icon-size-medium: 24px;
        --icon-size-large: 32px;
        --icon-size-extra-large: 48px;

        /* Border Radius */
        --radius-xs: 4px;
        --radius-sm: 8px;
        --radius-base: 12px;
        --radius-md: 16px;
        --radius-lg: 20px;
        --radius-xl: 24px;
        --radius-full: 9999px;

        /* Border Radius - Legacy Aliases */
        --radius-micro: var(--radius-xs);
        --radius-small: var(--radius-sm);
        --radius-large: var(--radius-md);
        --radius-xlarge: var(--radius-lg);
        --radius-xxlarge: var(--radius-xl);
        --radius-round: var(--radius-full);

        /* Border Width */
        --border-thin: 1px;
        --border-subtle: 1.5px;

        /* Typography - Font Family */
        --font-family: "SF Pro Display", "SF Pro Text", system-ui, -apple-system,
          BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial,
          sans-serif, "Apple Color Emoji", "Segoe UI Emoji";

        /* Typography - Font Sizes */
        --font-size-2xs: 10px;
        --font-size-xs: 11px;
        --font-size-sm: 13px;
        --font-size-base: 15px;
        --font-size-md: 16px;
        --font-size-lg: 18px;
        --font-size-xl: 21px;
        --font-size-2xl: 24px;

        /* Typography - Legacy Aliases */
        --font-size-screen-header: var(--font-size-md);
        --font-size-modal-header: var(--font-size-md);
        --font-size-list-title: var(--font-size-md);
        --font-size-list-subtitle: var(--font-size-sm);
        --font-size-input: var(--font-size-md);
        --font-size-button: 14px;
        --font-size-micro: var(--font-size-xs);

        /* Typography - Font Weights */
        --font-weight-light: 300;
        --font-weight-regular: 400;
        --font-weight-medium: 500;
        --font-weight-semibold: 600;

        /* Typography - Line Heights */
        --line-height-none: 1;
        --line-height-tight: 1.2;
        --line-height-snug: 1.35;
        --line-height-normal: 1.5;
        --line-height-relaxed: 1.6;

        /* Typography - Letter Spacing */
        --letter-spacing-tight: -0.02em;
        --letter-spacing-normal: 0;
        --letter-spacing-wide: 0.02em;
        --letter-spacing-wider: 0.05em;
        --letter-spacing-widest: 0.1em;

        /* Shadows (warm-tinted) */
        --shadow-sm: 0 1px 3px rgba(77, 63, 51, 0.06),
          0 1px 2px rgba(77, 63, 51, 0.04);
        --shadow-md: 0 10px 15px -3px rgba(77, 63, 51, 0.06),
          0 4px 6px -2px rgba(77, 63, 51, 0.03);
        --shadow-lg: 0 -8px 40px rgba(77, 63, 51, 0.3);
        --shadow-focus: 0 0 0 2px var(--color-canvas),
          0 0 0 5px rgba(179, 139, 109, 0.4);
        --shadow-focus-error: 0 0 0 2px var(--color-canvas),
          0 0 0 5px var(--color-semantic-error);

        /* Transitions */
        --duration-fast: 100ms;
        --duration-normal: 200ms;
        --duration-slow: 300ms;
        --ease-out: cubic-bezier(0, 0, 0.2, 1);
        --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
        --transition-colors: color var(--duration-fast) var(--ease-out),
          background-color var(--duration-fast) var(--ease-out),
          border-color var(--duration-fast) var(--ease-out);

        /* Z-Index Scale */
        --z-below: -1;
        --z-base: 0;
        --z-raised: 1;
        --z-dropdown: 10;
        --z-sticky: 20;
        --z-header: 30;
        --z-overlay: 40;
        --z-modal: 50;
        --z-toast: 60;
        --z-tooltip: 70;
        --z-max: 100;

        /* Safe Area */
        --safe-top: env(safe-area-inset-top, 0px);
        --safe-bottom: env(safe-area-inset-bottom, 0px);
        --max-width: 480px;
      }

      /* ===== Base Styles ===== */
      *,
      *::before,
      *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html {
        -moz-osx-font-smoothing: grayscale;
        text-rendering: optimizeLegibility;
      }

      html,
      body {
        background: var(--color-canvas);
        color: var(--color-text-primary);
        font-family: var(--font-family);
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-regular);
        line-height: var(--line-height-normal);
      }

      body {
        min-height: 100vh;
        min-height: 100dvh;
      }

      .container {
        max-width: var(--max-width);
        margin-inline: auto;
        min-height: 100vh;
        min-height: 100dvh;
        background: var(--color-canvas);
        display: flex;
        flex-direction: column;
      }

      button:focus,
      a:focus,
      [tabindex]:focus {
        outline: none;
      }

      :focus-visible {
        box-shadow: var(--shadow-focus);
      }

      a:focus-visible,
      [tabindex]:focus-visible {
        border-radius: var(--radius-sm);
      }

      [hidden] {
        display: none !important;
      }

      /* ===== Accessibility ===== */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
          scroll-behavior: auto !important;
        }
      }

      /* ===== Header ===== */
      .header {
        position: sticky;
        top: 0;
        z-index: var(--z-header);
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        align-items: center;
        height: calc(var(--height-header) + var(--safe-top));
        padding: var(--safe-top) var(--space-gutter) 0;
        background: var(--color-canvas);
        border-bottom: var(--border-thin) solid var(--color-border-medium);
      }

      .header__left {
        justify-self: start;
        margin-left: -14px;
      }

      .header__center {
        justify-self: center;
        font-size: var(--font-size-md);
        font-weight: var(--font-weight-medium);
        letter-spacing: var(--letter-spacing-wider);
        text-transform: uppercase;
      }

      .header__right {
        justify-self: end;
        margin-right: -14px;
      }

      /* ===== Icon Button ===== */
      .icon-button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        position: relative;
        width: var(--height-icon-button);
        height: var(--height-icon-button);
        min-width: var(--height-icon-button);
        min-height: var(--height-icon-button);
        padding: 0;
        background: transparent;
        border: none;
        border-radius: var(--radius-sm);
        color: var(--color-text-primary);
        cursor: pointer;
        transition: var(--transition-colors);
        -webkit-tap-highlight-color: transparent;
      }

      .icon-button:hover {
        background: var(--color-overlay-light);
      }

      .icon-button:active {
        background: var(--color-overlay-pressed);
      }

      .icon-button i {
        font-size: var(--icon-size-default);
        line-height: 1;
      }

      .icon-button--badge[data-badge]::after {
        content: attr(data-badge);
        position: absolute;
        top: 4px;
        right: 4px;
        min-width: 18px;
        height: 18px;
        padding: 0 5px;
        display: grid;
        place-items: center;
        border-radius: var(--radius-full);
        background: var(--color-accent-primary);
        color: var(--color-text-inverse);
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-medium);
        line-height: 1;
      }

      .icon-button--badge[data-badge="0"]::after {
        display: none;
      }

      /* ===== Order Summary Section ===== */
      .order-summary {
        background: var(--color-surface);
        border-top: 0;
        border-bottom: var(--border-thin) solid var(--color-border-medium);
      }

      /* Header */
      .order-summary__header {
        padding: var(--space-base) var(--space-large);
        display: flex;
        align-items: center;
        justify-content: space-between;
        cursor: pointer;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
      }

      .order-summary__header:active {
        background: var(--color-overlay-light);
      }

      .order-summary__header-left {
        display: flex;
        align-items: center;
        gap: var(--space-tiny);
      }

      .order-summary__title {
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-regular);
        letter-spacing: var(--letter-spacing-widest);
        text-transform: uppercase;
        line-height: var(--line-height-normal);
        color: var(--color-text-secondary);
        margin: 0;
      }

      .order-summary__toggle-icon {
        color: var(--color-text-tertiary);
        font-size: var(--icon-size-default);
        transition: transform 300ms ease;
      }

      .order-summary__toggle-icon.expanded {
        transform: rotate(180deg);
      }

      .order-summary__total {
        font-size: var(--font-size-md);
        font-weight: var(--font-weight-medium);
        color: var(--color-text-primary);
      }

      /* Content */
      .order-summary__content {
        border-top: var(--border-thin) solid var(--color-border-medium);
        padding: var(--space-large);
        display: flex;
        flex-direction: column;
        gap: var(--space-large);
      }

      /* Product Items */
      .order-summary__items {
        display: flex;
        flex-direction: column;
      }

      .order-item {
        display: flex;
        gap: var(--space-base);
        align-items: flex-start;
        padding-bottom: var(--space-base);
      }

      .order-item:first-child {
        padding-top: 0;
      }

      .order-item:last-child {
        padding-bottom: 0;
      }

      .order-item__image {
        width: 80px;
        height: 80px;
        border-radius: var(--radius-base);
        overflow: hidden;
        background: var(--color-surface);
        border: var(--border-thin) solid var(--color-border-light);
        flex-shrink: 0;
        position: relative;
      }

      .order-item__image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .order-item__text {
        flex: 1;
        min-width: 0;
        display: flex;
        flex-direction: column;
        gap: var(--space-micro);
      }

      .order-item__title {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-regular);
        line-height: 1.4;
        color: var(--color-text-primary);
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        line-clamp: 2;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .order-item__subtitle {
        font-size: var(--font-size-sm);
        font-weight: 400;
        letter-spacing: 0.2px;
        line-height: 1.4;
        color: var(--color-text-tertiary);
      }

      .order-item__price {
        font-size: var(--font-size-md);
        font-weight: var(--font-weight-medium);
        color: var(--color-text-primary);
        flex-shrink: 0;
      }

      /* Discount Code */
      .discount-code {
        display: flex;
        flex-direction: column;
        gap: var(--space-base);
      }

      .discount-code__input-row {
        display: flex;
        gap: var(--space-small);
      }

      .discount-code__input {
        flex: 1;
        height: var(--height-input);
        padding: 0 var(--space-base);
        background: var(--color-canvas);
        border: var(--border-subtle) solid var(--color-border-medium);
        border-radius: var(--radius-base);
        font-size: var(--font-size-md);
        font-weight: var(--font-weight-regular);
        color: var(--color-text-primary);
        font-family: var(--font-family);
        transition: border-color 150ms ease;
        outline: none;
      }

      .discount-code__input::placeholder {
        color: var(--color-text-whisper);
      }

      .discount-code__input:focus {
        outline: none;
        border-color: var(--color-border-focused);
        box-shadow: var(--shadow-focus);
      }

      .discount-code__input.error {
        border-color: var(--color-semantic-error);
      }

      /* Error Message */
      .error-message {
        font-size: var(--font-size-sm);
        font-weight: 400;
        letter-spacing: 0.2px;
        line-height: 18px;
        color: var(--color-semantic-error);
        margin-top: calc(var(--space-tiny) - var(--space-base));
        display: none;
      }

      .error-message.visible {
        display: block;
      }

      .discount-code__button {
        padding: 0 var(--space-large);
        height: var(--height-button);
        background: var(--color-accent-nude);
        border: var(--border-thin) solid var(--color-accent-nude);
        border-radius: var(--radius-sm);
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-medium);
        letter-spacing: var(--letter-spacing-wider);
        text-transform: uppercase;
        color: var(--color-text-primary);
        cursor: pointer;
        transition: all 120ms ease;
        font-family: var(--font-family);
        flex-shrink: 0;
      }

      .discount-code__button:hover:not(:disabled) {
        background: var(--color-accent-blush);
        border-color: var(--color-accent-blush);
      }

      .discount-code__button:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }

      .discount-code__button:not(:disabled):active {
        background: var(--color-accent-clay);
        border-color: var(--color-accent-clay);
        transform: scale(0.98);
      }

      /* Applied Discount Tag */
      .applied-discount {
        display: none;
        align-items: center;
        gap: var(--space-tiny);
        padding: var(--space-tiny) var(--space-tiny) var(--space-tiny)
          var(--space-small);
        background: var(--color-overlay-light);
        border: var(--border-thin) solid var(--color-border-light);
        border-radius: var(--radius-small);
        width: fit-content;
      }

      .applied-discount.visible {
        display: flex;
      }

      .applied-discount__code {
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-medium);
        color: var(--color-text-primary);
      }

      .applied-discount__remove {
        background: none;
        border: none;
        padding: 0;
        margin: 0;
        cursor: pointer;
        color: var(--color-text-tertiary);
        font-size: var(--icon-size-small);
        line-height: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: color 120ms ease;
        -webkit-tap-highlight-color: transparent;
      }

      .applied-discount__remove:hover {
        color: var(--color-text-primary);
      }

      .applied-discount__remove:active {
        transform: scale(0.95);
      }

      /* Summary Rows */
      .summary-rows {
        display: flex;
        flex-direction: column;
      }

      .summary-row {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: var(--space-base);
        padding: var(--space-small) 0;
      }

      .summary-row:first-child {
        padding-top: 0;
      }

      .summary-row__label {
        font-size: var(--font-size-base);
        color: var(--color-text-secondary);
        flex-shrink: 0;
        min-width: 80px;
      }

      .summary-row__value {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-medium);
        color: var(--color-text-primary);
        text-align: right;
        flex: 1;
        font-variant-numeric: tabular-nums;
      }

      .summary-row__value--muted {
        color: var(--color-text-tertiary);
      }

      /* Discount Row */
      .summary-row--discount {
        display: none;
      }

      .summary-row--discount.visible {
        display: flex;
      }

      .summary-row--discount .summary-row__value {
        color: var(--color-accent-primary);
      }

      /* Total Row */
      .summary-row--total {
        padding-top: var(--space-small);
      }

      .summary-row--total .summary-row__label {
        font-weight: var(--font-weight-medium);
        color: var(--color-text-primary);
      }

      /* ===== Contact Section ===== */
      .contact-section {
        padding: var(--space-large);
        display: flex;
        flex-direction: column;
        gap: var(--space-base);
      }

      .section-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .section-header__title {
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-regular);
        letter-spacing: var(--letter-spacing-widest);
        text-transform: uppercase;
        line-height: var(--line-height-normal);
        color: var(--color-text-secondary);
        margin: 0;
      }

      /* ===== Delivery Section ===== */
      .delivery-section {
        padding: var(--space-large);
        display: flex;
        flex-direction: column;
        gap: var(--space-base);
      }

      /* Stacked Radio Options */
      .radio-stack {
        display: flex;
        flex-direction: column;
      }

      .radio-option {
        position: relative;
      }

      .radio-option input[type="radio"] {
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
      }

      .radio-option__label {
        display: flex;
        align-items: center;
        gap: var(--space-base);
        padding: var(--space-base);
        min-height: var(--height-input);
        background: var(--color-canvas);
        border: var(--border-subtle) solid var(--color-border-medium);
        border-radius: 0;
        cursor: pointer;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
        position: relative;
        z-index: 1;
      }

      /* First option gets top border radius and no bottom border */
      .radio-option:first-child .radio-option__label {
        border-top-left-radius: var(--radius-base);
        border-top-right-radius: var(--radius-base);
        border-bottom: 0;
      }

      /* Last option gets bottom border radius and no top border */
      .radio-option:last-child .radio-option__label {
        border-bottom-left-radius: var(--radius-base);
        border-bottom-right-radius: var(--radius-base);
        border-top: 0;
      }

      /* When first option is checked, add back bottom border in accent color */
      .radio-option:first-child
        input[type="radio"]:checked
        + .radio-option__label {
        border-bottom: var(--border-subtle) solid var(--color-accent-nude);
      }

      /* When last option is checked, add back top border in accent color */
      .radio-option:last-child
        input[type="radio"]:checked
        + .radio-option__label {
        border-top: var(--border-subtle) solid var(--color-accent-nude);
      }

      .radio-option input[type="radio"]:checked + .radio-option__label {
        border-color: var(--color-accent-nude);
        background: var(--color-accent-sand);
        z-index: 2;
      }

      /* Custom Radio Button */
      .radio-option__radio {
        width: 20px;
        height: 20px;
        border-radius: var(--radius-round);
        border: var(--border-subtle) solid var(--color-border-medium);
        background: var(--color-canvas);
        flex-shrink: 0;
        position: relative;
      }

      .radio-option
        input[type="radio"]:checked
        + .radio-option__label
        .radio-option__radio {
        border-color: var(--color-accent-nude);
        background: var(--color-accent-nude);
      }

      .radio-option__radio::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        width: 8px;
        height: 8px;
        border-radius: var(--radius-round);
        background: var(--color-canvas);
      }

      .radio-option
        input[type="radio"]:checked
        + .radio-option__label
        .radio-option__radio::after {
        transform: translate(-50%, -50%) scale(1);
      }

      /* Content */
      .radio-option__content {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: var(--space-micro);
      }

      .radio-option__title {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-regular);
        color: var(--color-text-primary);
      }

      .radio-option__icon {
        font-size: var(--icon-size-default);
        color: var(--color-text-tertiary);
        flex-shrink: 0;
        margin-left: auto;
      }

      /* Shipping Forms Wrapper */
      .shipping-forms-wrapper {
        display: flex;
        flex-direction: column;
        gap: var(--space-base);
      }

      /* Shipping Section (subsection pattern) */
      .shipping-section {
        display: flex;
        flex-direction: column;
        gap: var(--space-base);
      }

      .shipping-section__header {
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-regular);
        letter-spacing: var(--letter-spacing-widest);
        text-transform: uppercase;
        line-height: var(--line-height-normal);
        color: var(--color-text-secondary);
        margin: 0;
      }

      .shipping-section__header-group {
        display: flex;
        flex-direction: column;
        gap: var(--space-micro);
      }

      .shipping-section__subtext {
        font-size: var(--font-size-sm);
        color: var(--color-text-tertiary);
        margin: 0;
      }

      /* Form Fields Container */
      .form-fields {
        display: flex;
        flex-direction: column;
        gap: var(--space-base);
      }

      /* Form Input */
      .form-input {
        width: 100%;
        height: var(--height-input);
        padding: 0 var(--space-base);
        background: var(--color-canvas);
        border: var(--border-subtle) solid var(--color-border-medium);
        border-radius: var(--radius-base);
        font-size: var(--font-size-md);
        font-weight: var(--font-weight-regular);
        color: var(--color-text-primary);
        font-family: var(--font-family);
        transition: border-color 150ms ease;
        outline: none;
      }

      .form-input::placeholder {
        color: var(--color-text-whisper);
      }

      .form-input:hover:not(:focus):not(:disabled) {
        border-color: var(--color-border-strong);
      }

      .form-input:focus {
        outline: none;
        border-color: var(--color-border-focused);
        box-shadow: var(--shadow-focus);
      }

      .form-input:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }

      /* Form Input with Icon */
      .form-input-wrapper {
        position: relative;
      }

      .form-input-icon {
        position: absolute;
        right: var(--space-base);
        top: 50%;
        transform: translateY(-50%);
        font-size: var(--icon-size-default);
        color: var(--color-text-tertiary);
        pointer-events: none;
      }

      .form-input-icon--help {
        pointer-events: all;
        cursor: help;
      }

      /* Tooltip */
      .tooltip {
        position: absolute;
        bottom: calc(100% + var(--space-tiny));
        right: 0;
        background: var(--color-text-primary);
        color: var(--color-white);
        padding: var(--space-small) var(--space-base);
        border-radius: var(--radius-base);
        font-size: var(--font-size-sm);
        font-weight: 400;
        letter-spacing: 0.2px;
        line-height: 1.4;
        max-width: 240px;
        opacity: 0;
        visibility: hidden;
        transition: opacity 150ms ease, visibility 150ms ease;
        pointer-events: none;
        z-index: var(--z-tooltip);
      }

      .tooltip::after {
        content: "";
        position: absolute;
        top: 100%;
        right: var(--space-base);
        border: 6px solid transparent;
        border-top-color: var(--color-text-primary);
      }

      .tooltip--visible {
        opacity: 1;
        visibility: visible;
      }

      /* Select Dropdown */
      .form-select {
        position: relative;
      }

      .form-select select {
        width: 100%;
        height: var(--height-input);
        padding: 0 var(--space-base);
        padding-right: calc(
          var(--space-base) + var(--icon-size-default) + var(--space-tiny)
        );
        background: var(--color-canvas);
        border: var(--border-subtle) solid var(--color-border-medium);
        border-radius: var(--radius-base);
        font-size: var(--font-size-md);
        font-weight: var(--font-weight-regular);
        color: var(--color-text-primary);
        font-family: var(--font-family);
        cursor: pointer;
        appearance: none;
        transition: border-color 150ms ease;
        outline: none;
      }

      .form-select select.placeholder {
        color: var(--color-text-whisper);
      }

      .form-select select:focus {
        border-color: var(--color-border-focused);
      }

      .form-select-text {
        width: 100%;
        height: var(--height-input);
        padding: 0 var(--space-base);
        padding-right: calc(
          var(--space-base) + var(--icon-size-default) + var(--space-tiny)
        );
        background: var(--color-canvas);
        border: var(--border-subtle) solid var(--color-border-medium);
        border-radius: var(--radius-base);
        font-size: var(--font-size-md);
        font-weight: var(--font-weight-regular);
        color: var(--color-text-primary);
        font-family: var(--font-family);
        cursor: pointer;
        appearance: none;
        transition: border-color 150ms ease;
        outline: none;
        display: flex;
        align-items: center;
      }

      .form-select-text.placeholder {
        color: var(--color-text-whisper);
      }

      .form-select-icon {
        position: absolute;
        right: var(--space-base);
        top: 50%;
        transform: translateY(-50%);
        font-size: var(--icon-size-default);
        color: var(--color-text-tertiary);
        pointer-events: none;
      }

      .helper-message {
        background: var(--color-background);
        padding: var(--space-base);
        border-radius: var(--radius-base);
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-regular);
        color: var(--color-text-tertiary);
      }

      /* Shipping Options Container (like pickup-locations) */
      .shipping-options {
        display: flex;
        flex-direction: column;
      }

      .shipping-option {
        position: relative;
      }

      .shipping-option input[type="radio"] {
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
      }

      .shipping-option__label {
        display: flex;
        gap: var(--space-base);
        padding: var(--space-base);
        align-items: flex-start;
        min-height: var(--height-input);
        background: var(--color-canvas);
        border: var(--border-subtle) solid var(--color-border-medium);
        border-radius: 0;
        cursor: pointer;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
        position: relative;
        z-index: 1;
      }

      /* Only child (single item in section) gets full border radius */
      .shipping-options .shipping-option:only-child .shipping-option__label {
        border-radius: var(--radius-base);
      }

      /* First option (when multiple items) gets top border radius */
      .shipping-options
        .shipping-option:first-child:not(:only-child)
        .shipping-option__label {
        border-top-left-radius: var(--radius-base);
        border-top-right-radius: var(--radius-base);
      }

      /* Last option (when multiple items) gets bottom border radius */
      .shipping-options
        .shipping-option:last-child:not(:only-child)
        .shipping-option__label {
        border-bottom-left-radius: var(--radius-base);
        border-bottom-right-radius: var(--radius-base);
      }

      /* All non-first options remove top border (share with previous item's bottom) */
      .shipping-options
        .shipping-option:not(:first-child)
        .shipping-option__label {
        border-top: 0;
      }

      /* When next sibling is checked, hide this item's bottom border */
      .shipping-options
        .shipping-option:has(+ .shipping-option input[type="radio"]:checked)
        .shipping-option__label {
        border-bottom: 0;
      }

      /* When a non-first option is checked, add back its top border in accent color */
      .shipping-options
        .shipping-option:not(:first-child)
        input[type="radio"]:checked
        + .shipping-option__label {
        border-top: var(--border-subtle) solid var(--color-accent-nude);
      }

      .shipping-option input[type="radio"]:checked + .shipping-option__label {
        border-color: var(--color-accent-nude);
        background: var(--color-accent-sand);
        z-index: 2;
      }

      /* Custom Radio Button for Shipping */
      .shipping-option__radio {
        width: 20px;
        height: 20px;
        border-radius: var(--radius-round);
        border: var(--border-subtle) solid var(--color-border-medium);
        background: var(--color-canvas);
        flex-shrink: 0;
        position: relative;
        margin-top: 2px;
      }

      .shipping-option
        input[type="radio"]:checked
        + .shipping-option__label
        .shipping-option__radio {
        border-color: var(--color-accent-nude);
        background: var(--color-accent-nude);
      }

      .shipping-option__radio::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        width: 8px;
        height: 8px;
        border-radius: var(--radius-round);
        background: var(--color-canvas);
      }

      .shipping-option
        input[type="radio"]:checked
        + .shipping-option__label
        .shipping-option__radio::after {
        transform: translate(-50%, -50%) scale(1);
      }

      /* Content */
      .shipping-option__content {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: var(--space-micro);
      }

      .shipping-option__title {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-regular);
        color: var(--color-text-primary);
      }

      .shipping-option__detail {
        font-size: var(--font-size-sm);
        font-weight: 400;
        letter-spacing: 0.2px;
        line-height: 1.4;
        color: var(--color-text-tertiary);
      }

      /* Price */
      .shipping-option__price {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-medium);
        color: var(--color-text-primary);
        flex-shrink: 0;
        align-self: flex-start;
      }

      /* Show More Button */
      .show-more-button {
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-medium);
        letter-spacing: var(--letter-spacing-wider);
        color: var(--color-accent-primary);
        background: none;
        border: none;
        cursor: pointer;
        padding: 0;
        margin: 0;
        font-family: var(--font-family);
        text-align: left;
        -webkit-tap-highlight-color: transparent;
      }

      .show-more-button:active {
        opacity: 0.8;
      }

      /* Pickup Locations Wrapper */
      .pickup-locations-wrapper {
        display: flex;
        flex-direction: column;
        gap: var(--space-base);
      }

      /* Pickup Section */
      .pickup-section {
        display: flex;
        flex-direction: column;
        gap: var(--space-base);
      }

      /* Pickup subsection headers - same size as main sections, hierarchy through weight and color */
      .pickup-section__header {
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-regular);
        letter-spacing: var(--letter-spacing-widest);
        text-transform: uppercase;
        line-height: var(--line-height-normal);
        color: var(--color-text-secondary);
        margin: 0;
      }

      /* Pickup Locations (stacked within each section) */
      .pickup-locations {
        display: flex;
        flex-direction: column;
      }

      .pickup-option {
        position: relative;
      }

      .pickup-option input[type="radio"] {
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
      }

      .pickup-option__label {
        display: flex;
        gap: var(--space-base);
        padding: var(--space-base);
        align-items: flex-start;
        min-height: var(--height-input);
        background: var(--color-canvas);
        border: var(--border-subtle) solid var(--color-border-medium);
        border-radius: 0;
        cursor: pointer;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
        position: relative;
        z-index: 1;
      }

      /* Only child (single item in section) gets full border radius */
      .pickup-locations .pickup-option:only-child .pickup-option__label {
        border-radius: var(--radius-base);
      }

      /* First option (when multiple items) gets top border radius */
      .pickup-locations
        .pickup-option:first-child:not(:only-child)
        .pickup-option__label {
        border-top-left-radius: var(--radius-base);
        border-top-right-radius: var(--radius-base);
      }

      /* Last option (when multiple items) gets bottom border radius */
      .pickup-locations
        .pickup-option:last-child:not(:only-child)
        .pickup-option__label {
        border-bottom-left-radius: var(--radius-base);
        border-bottom-right-radius: var(--radius-base);
      }

      /* All non-first options remove top border (share with previous item's bottom) */
      .pickup-locations .pickup-option:not(:first-child) .pickup-option__label {
        border-top: 0;
      }

      /* When next sibling is checked, hide this item's bottom border */
      .pickup-locations
        .pickup-option:has(+ .pickup-option input[type="radio"]:checked)
        .pickup-option__label {
        border-bottom: 0;
      }

      /* When a non-first option is checked, add back its top border in accent color */
      .pickup-locations
        .pickup-option:not(:first-child)
        input[type="radio"]:checked
        + .pickup-option__label {
        border-top: var(--border-subtle) solid var(--color-accent-nude);
      }

      .pickup-option input[type="radio"]:checked + .pickup-option__label {
        border-color: var(--color-accent-nude);
        background: var(--color-accent-sand);
        z-index: 2;
      }

      /* Custom Radio Button */
      .pickup-option__radio {
        width: 20px;
        height: 20px;
        border-radius: var(--radius-round);
        border: var(--border-subtle) solid var(--color-border-medium);
        background: var(--color-canvas);
        flex-shrink: 0;
        position: relative;
        margin-top: 2px;
      }

      .pickup-option
        input[type="radio"]:checked
        + .pickup-option__label
        .pickup-option__radio {
        border-color: var(--color-accent-nude);
        background: var(--color-accent-nude);
      }

      .pickup-option__radio::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        width: 8px;
        height: 8px;
        border-radius: var(--radius-round);
        background: var(--color-canvas);
      }

      .pickup-option
        input[type="radio"]:checked
        + .pickup-option__label
        .pickup-option__radio::after {
        transform: translate(-50%, -50%) scale(1);
      }

      /* Content */
      .pickup-option__content {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: var(--space-micro);
      }

      .pickup-option__title {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-regular);
        color: var(--color-text-primary);
      }

      .pickup-option__detail {
        font-size: var(--font-size-sm);
        font-weight: 400;
        letter-spacing: 0.2px;
        line-height: 1.4;
        color: var(--color-text-tertiary);
      }

      /* Price */
      .pickup-option__price {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-medium);
        color: var(--color-text-primary);
        flex-shrink: 0;
        align-self: flex-start;
      }

      /* Hidden pickup options */
      .pickup-option--hidden {
        display: none;
      }

      /* Last visible option gets bottom border radius (handled dynamically via JS) */
      .pickup-option.last-visible .pickup-option__label {
        border-bottom-left-radius: var(--radius-base);
        border-bottom-right-radius: var(--radius-base);
      }

      /* When last visible option is checked, add back top border in accent color */
      .pickup-option.last-visible
        input[type="radio"]:checked
        + .pickup-option__label {
        border-top: var(--border-subtle) solid var(--color-accent-nude);
      }

      /* ===== Payment Section ===== */
      .payment-section {
        padding: var(--space-large);
        display: flex;
        flex-direction: column;
        gap: var(--space-base);
      }

      /* Section Header Subtitle (addition to existing section-header) */
      .section-header__subtitle {
        font-size: var(--font-size-sm);
        color: var(--color-text-tertiary);
        margin: 0;
      }

      /* Section Header for Payment (update to support column layout) */
      .section-header--column {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--space-micro);
      }

      /* Payment Options Stack */
      .payment-options {
        display: flex;
        flex-direction: column;
      }

      .payment-option {
        position: relative;
      }

      .payment-option input[type="radio"] {
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
      }

      /* Wrapper for credit card option (contains label + form) - no border, just container */
      .payment-option__wrapper {
        background: var(--color-canvas);
        border: 0;
        border-radius: 0;
        position: relative;
        z-index: 1;
        overflow: hidden;
      }

      /* First option wrapper gets top border radius */
      .payment-option:first-child .payment-option__wrapper {
        border-top-left-radius: var(--radius-base);
        border-top-right-radius: var(--radius-base);
      }

      /* When credit card (first option) is checked, wrapper background changes to match form */
      .payment-option:first-child
        input[type="radio"]:checked
        + .payment-option__wrapper {
        background: var(--color-background);
        z-index: 2;
      }

      /* Label inside first wrapper needs full border */
      .payment-option:first-child
        .payment-option__wrapper
        .payment-option__label {
        border: var(--border-subtle) solid var(--color-border-medium);
        border-top-left-radius: var(--radius-base);
        border-top-right-radius: var(--radius-base);
      }

      /* When next sibling payment option is checked, hide the label's bottom border */
      .payment-option:first-child:has(
          + .payment-option input[type="radio"]:checked
        )
        .payment-option__wrapper
        .payment-option__label {
        border-bottom: 0;
      }

      /* When credit card is checked, label gets accent border on ALL 4 sides */
      .payment-option:first-child
        input[type="radio"]:checked
        + .payment-option__wrapper
        .payment-option__label {
        border-color: var(--color-accent-nude);
        background: var(--color-background);
      }

      /* When credit card is checked, hide form's top border to prevent double border */
      .payment-option:first-child
        input[type="radio"]:checked
        + .payment-option__wrapper
        .credit-card-form {
        border-top: 0;
      }

      /* Payment Option Label (inside wrapper for credit card, standalone for others) */
      .payment-option__label {
        display: flex;
        align-items: center;
        gap: var(--space-base);
        padding: var(--space-base);
        min-height: var(--height-input);
        background: var(--color-canvas);
        cursor: pointer;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
        width: 100%;
      }

      /* Labels for non-first options need borders and remove top border */
      .payment-option:not(:first-child) .payment-option__label {
        border: var(--border-subtle) solid var(--color-border-medium);
        border-radius: 0;
        border-top: 0;
        position: relative;
        z-index: 1;
      }

      /* Last option label gets bottom radius ONLY when not checked */
      .payment-option:last-child .payment-option__label {
        border-bottom-left-radius: var(--radius-base);
        border-bottom-right-radius: var(--radius-base);
      }

      /* When last option is checked, remove bottom radius from label */
      .payment-option:last-child
        input[type="radio"]:checked
        + .payment-option__label {
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
      }

      /* When next sibling is checked, hide this item's bottom border */
      .payment-option:has(+ .payment-option input[type="radio"]:checked)
        .payment-option__label {
        border-bottom: 0;
      }

      /* When non-first options are checked, change border color, add back top border in accent, and change background */
      .payment-option:not(:first-child)
        input[type="radio"]:checked
        + .payment-option__label {
        border-color: var(--color-accent-nude);
        border-top: var(--border-subtle) solid var(--color-accent-nude);
        background: var(--color-accent-sand);
        z-index: 2;
      }

      /* When last option (PayPal) is checked, change background to match context */
      .payment-option:last-child
        input[type="radio"]:checked
        + .payment-option__label {
        background: var(--color-background);
      }

      /* When PayPal is checked, hide context's top border to prevent double border */
      .payment-option:last-child input[type="radio"]:checked ~ .paypal-context {
        border-top: 0;
      }

      /* Custom Radio Button */
      .payment-option__radio {
        width: 20px;
        height: 20px;
        border-radius: var(--radius-round);
        border: var(--border-subtle) solid var(--color-border-medium);
        background: var(--color-canvas);
        flex-shrink: 0;
        position: relative;
      }

      /* Credit card radio (with wrapper) */
      .payment-option
        input[type="radio"]:checked
        + .payment-option__wrapper
        .payment-option__radio {
        border-color: var(--color-accent-nude);
        background: var(--color-accent-nude);
      }

      /* PayPal radio (without wrapper, direct label) */
      .payment-option
        input[type="radio"]:checked
        + .payment-option__label
        .payment-option__radio {
        border-color: var(--color-accent-nude);
        background: var(--color-accent-nude);
      }

      .payment-option__radio::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        width: 8px;
        height: 8px;
        border-radius: var(--radius-round);
        background: var(--color-canvas);
      }

      /* Credit card radio dot (with wrapper) */
      .payment-option
        input[type="radio"]:checked
        + .payment-option__wrapper
        .payment-option__radio::after {
        transform: translate(-50%, -50%) scale(1);
      }

      /* PayPal radio dot (without wrapper, direct label) */
      .payment-option
        input[type="radio"]:checked
        + .payment-option__label
        .payment-option__radio::after {
        transform: translate(-50%, -50%) scale(1);
      }

      /* Content */
      .payment-option__content {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: var(--space-micro);
      }

      .payment-option__title {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-regular);
        color: var(--color-text-primary);
      }

      /* Credit Card Form */
      .credit-card-form {
        display: none;
        padding: var(--space-base);
        padding-top: var(--space-base);
        flex-direction: column;
        gap: var(--space-base);
        background: var(--color-background);
        border-top: var(--border-subtle) solid var(--color-border-medium);
        border-left: var(--border-subtle) solid var(--color-border-medium);
        border-right: var(--border-subtle) solid var(--color-border-medium);
        border-bottom: var(--border-subtle) solid var(--color-border-medium);
      }

      /* Show form when credit card is selected */
      .payment-option:first-child
        input[type="radio"]:checked
        + .payment-option__wrapper
        .credit-card-form {
        display: flex;
      }

      /* PayPal Context */
      .paypal-context {
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: var(--space-base);
        padding: var(--space-xlarge) var(--space-large);
        background: var(--color-background);
        text-align: center;
        border-top: var(--border-subtle) solid var(--color-border-medium);
        border-left: var(--border-subtle) solid var(--color-border-medium);
        border-right: var(--border-subtle) solid var(--color-border-medium);
        border-bottom: var(--border-subtle) solid var(--color-border-medium);
        border-bottom-left-radius: var(--radius-base);
        border-bottom-right-radius: var(--radius-base);
      }

      /* Show PayPal context when selected */
      .payment-option:last-child input[type="radio"]:checked ~ .paypal-context {
        display: flex;
      }

      .paypal-context__icon {
        width: 80px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--color-text-tertiary);
      }

      .paypal-context__icon i {
        font-size: var(--icon-size-extra-large);
      }

      .paypal-context__text {
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-regular);
        color: var(--color-text-secondary);
        max-width: 320px;
      }

      /* Billing Address Section */
      .billing-section {
        display: flex;
        flex-direction: column;
        gap: var(--space-base);
      }

      .billing-section__header {
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-regular);
        letter-spacing: var(--letter-spacing-widest);
        text-transform: uppercase;
        line-height: var(--line-height-normal);
        color: var(--color-text-secondary);
        margin: 0;
      }

      /* Billing Options Stack */
      .billing-options {
        display: flex;
        flex-direction: column;
      }

      .billing-option {
        position: relative;
      }

      .billing-option input[type="radio"] {
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
      }

      /* Wrapper for last billing option (contains label + form) - no border, just container */
      .billing-option__wrapper {
        background: var(--color-canvas);
        border: 0;
        border-radius: 0;
        position: relative;
        z-index: 1;
        overflow: hidden;
      }

      /* Last option wrapper gets bottom border radius */
      .billing-option:last-child .billing-option__wrapper {
        border-bottom-left-radius: var(--radius-base);
        border-bottom-right-radius: var(--radius-base);
      }

      /* When last billing option is checked, wrapper background changes to match form */
      .billing-option:last-child
        input[type="radio"]:checked
        + .billing-option__wrapper {
        background: var(--color-background);
        z-index: 2;
      }

      /* Billing Option Label */
      .billing-option__label {
        display: flex;
        align-items: center;
        gap: var(--space-base);
        padding: var(--space-base);
        min-height: var(--height-input);
        background: var(--color-canvas);
        cursor: pointer;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
        width: 100%;
      }

      /* First option label - standalone, needs borders */
      .billing-option:first-child .billing-option__label {
        border: var(--border-subtle) solid var(--color-border-medium);
        border-top-left-radius: var(--radius-base);
        border-top-right-radius: var(--radius-base);
        border-bottom: 0;
        position: relative;
        z-index: 1;
      }

      /* When first option is checked */
      .billing-option:first-child
        input[type="radio"]:checked
        + .billing-option__label {
        border-color: var(--color-accent-nude);
        border-bottom: var(--border-subtle) solid var(--color-accent-nude);
        background: var(--color-accent-sand);
        z-index: 2;
      }

      /* When next sibling (last option) is checked, hide first option's bottom border */
      .billing-option:first-child:has(
          + .billing-option input[type="radio"]:checked
        )
        .billing-option__label {
        border-bottom: 0;
      }

      /* Label inside last option wrapper needs full border */
      .billing-option:last-child
        .billing-option__wrapper
        .billing-option__label {
        border: var(--border-subtle) solid var(--color-border-medium);
        border-top: 0;
        border-bottom-left-radius: var(--radius-base);
        border-bottom-right-radius: var(--radius-base);
      }

      /* When last option is checked, label gets accent border on ALL 4 sides */
      .billing-option:last-child
        input[type="radio"]:checked
        + .billing-option__wrapper
        .billing-option__label {
        border-color: var(--color-accent-nude);
        border-top: var(--border-subtle) solid var(--color-accent-nude);
        background: var(--color-background);
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
      }

      /* Custom Radio Button */
      .billing-option__radio {
        width: 20px;
        height: 20px;
        border-radius: var(--radius-round);
        border: var(--border-subtle) solid var(--color-border-medium);
        background: var(--color-canvas);
        flex-shrink: 0;
        position: relative;
      }

      .billing-option:first-child
        input[type="radio"]:checked
        + .billing-option__label
        .billing-option__radio,
      .billing-option:last-child
        input[type="radio"]:checked
        + .billing-option__wrapper
        .billing-option__label
        .billing-option__radio {
        border-color: var(--color-accent-nude);
        background: var(--color-accent-nude);
      }

      .billing-option__radio::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        width: 8px;
        height: 8px;
        border-radius: var(--radius-round);
        background: var(--color-canvas);
      }

      .billing-option:first-child
        input[type="radio"]:checked
        + .billing-option__label
        .billing-option__radio::after,
      .billing-option:last-child
        input[type="radio"]:checked
        + .billing-option__wrapper
        .billing-option__label
        .billing-option__radio::after {
        transform: translate(-50%, -50%) scale(1);
      }

      /* Content */
      .billing-option__content {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: var(--space-micro);
      }

      .billing-option__title {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-regular);
        color: var(--color-text-primary);
      }

      /* Billing Address Form */
      .billing-address-form {
        display: none;
        flex-direction: column;
        gap: var(--space-base);
        padding: var(--space-base);
        background: var(--color-background);
        border: var(--border-subtle) solid var(--color-border-medium);
        border-top: 0;
        border-bottom-left-radius: var(--radius-base);
        border-bottom-right-radius: var(--radius-base);
      }

      /* Show billing address form when last option is checked */
      .billing-option:last-child
        input[type="radio"]:checked
        + .billing-option__wrapper
        .billing-address-form {
        display: flex;
      }

      .billing-address-form .form-input,
      .billing-address-form .form-select select,
      .billing-address-form .form-select-text {
        background: var(--color-canvas);
      }

      /* Form Fields Container */
      .form-fields {
        display: flex;
        flex-direction: column;
        gap: var(--space-base);
      }

      /* ===== Bottom Order Summary ===== */
      .bottom-order-summary {
        background: var(--color-surface);
        border-top: var(--border-thin) solid var(--color-border-medium);
        border-bottom: var(--border-thin) solid var(--color-border-medium);
      }

      /* Order Summary Header (Toggle) */
      .summary-header {
        padding: var(--space-base) var(--space-large);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      /* Content Wrapper */
      .summary-content {
        border-top: var(--border-thin) solid var(--color-border-medium);
        padding: var(--space-large);
        display: flex;
        flex-direction: column;
        gap: var(--space-large);
      }

      .summary-header__title {
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-regular);
        letter-spacing: var(--letter-spacing-widest);
        text-transform: uppercase;
        line-height: var(--line-height-normal);
        color: var(--color-text-secondary);
        margin: 0;
      }

      /* Product Items (Collapsible Section) */
      .product-items {
        display: flex;
        flex-direction: column;
      }

      .product-items.hidden {
        display: none;
      }

      .product-items .product-item {
        display: flex;
        gap: var(--space-base);
        align-items: flex-start;
        padding-bottom: var(--space-base);
      }

      .product-items .product-item:first-child {
        padding-top: 0;
      }

      .product-items .product-item:last-child {
        padding-bottom: 0;
      }

      .product-items .product-item__image {
        width: 80px;
        height: 80px;
        border-radius: var(--radius-base);
        overflow: hidden;
        background: var(--color-surface);
        border: var(--border-thin) solid var(--color-border-light);
        flex-shrink: 0;
      }

      .product-items .product-item__image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .product-items .product-item__text {
        flex: 1;
        min-width: 0;
        display: flex;
        flex-direction: column;
        gap: var(--space-micro);
      }

      .product-items .product-item__title {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-regular);
        color: var(--color-text-primary);
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        line-clamp: 2;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .product-items .product-item__subtitle {
        font-size: var(--font-size-sm);
        font-weight: 400;
        letter-spacing: 0.2px;
        line-height: 1.4;
        color: var(--color-text-tertiary);
      }

      .product-items .product-item__price {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-medium);
        color: var(--color-text-primary);
        flex-shrink: 0;
      }

      /* Discount Code (Always Visible) - Scoped for bottom summary */
      .bottom-order-summary .discount-code {
        display: flex;
        flex-direction: column;
        gap: var(--space-base);
      }

      .bottom-order-summary .discount-code__input-row {
        display: flex;
        gap: var(--space-small);
      }

      .bottom-order-summary .discount-code__input {
        flex: 1;
        height: var(--height-input);
        padding: 0 var(--space-base);
        background: var(--color-canvas);
        border: var(--border-subtle) solid var(--color-border-medium);
        border-radius: var(--radius-base);
        font-size: var(--font-size-md);
        font-weight: var(--font-weight-regular);
        color: var(--color-text-primary);
        font-family: var(--font-family);
        transition: border-color 150ms ease;
        outline: none;
      }

      .bottom-order-summary .discount-code__input::placeholder {
        color: var(--color-text-whisper);
      }

      .bottom-order-summary .discount-code__input:focus {
        outline: none;
        border-color: var(--color-border-focused);
        box-shadow: var(--shadow-focus);
      }

      .bottom-order-summary .discount-code__input.error {
        border-color: var(--color-semantic-error);
      }

      /* Error Message */
      .bottom-order-summary .error-message {
        font-size: var(--font-size-sm);
        font-weight: 400;
        letter-spacing: 0.2px;
        line-height: 1.4;
        color: var(--color-semantic-error);
        margin-top: calc(var(--space-tiny) - var(--space-base));
        display: none;
      }

      .bottom-order-summary .error-message.visible {
        display: block;
      }

      .bottom-order-summary .discount-code__button {
        padding: 0 var(--space-large);
        height: var(--height-button);
        background: var(--color-accent-nude);
        border: var(--border-thin) solid var(--color-accent-nude);
        border-radius: var(--radius-sm);
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-medium);
        letter-spacing: var(--letter-spacing-wider);
        text-transform: uppercase;
        color: var(--color-text-primary);
        cursor: pointer;
        transition: all 120ms ease;
        font-family: var(--font-family);
        flex-shrink: 0;
      }

      .bottom-order-summary .discount-code__button:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }

      .bottom-order-summary .discount-code__button:not(:disabled):active {
        transform: scale(0.98);
      }

      /* Applied Discount Tag */
      .bottom-order-summary .applied-discount {
        display: none;
        align-items: center;
        gap: var(--space-tiny);
        padding: var(--space-tiny) var(--space-tiny) var(--space-tiny)
          var(--space-small);
        background: var(--color-overlay-light);
        border: var(--border-thin) solid var(--color-border-light);
        border-radius: var(--radius-small);
        width: fit-content;
      }

      .bottom-order-summary .applied-discount.visible {
        display: flex;
      }

      .bottom-order-summary .applied-discount__code {
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-medium);
        color: var(--color-text-primary);
      }

      .bottom-order-summary .applied-discount__remove {
        background: none;
        border: none;
        padding: 0;
        margin: 0;
        cursor: pointer;
        color: var(--color-text-tertiary);
        font-size: var(--icon-size-small);
        line-height: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: color 120ms ease;
        -webkit-tap-highlight-color: transparent;
      }

      .bottom-order-summary .applied-discount__remove:hover {
        color: var(--color-text-primary);
      }

      .bottom-order-summary .applied-discount__remove:active {
        transform: scale(0.95);
      }

      /* Summary Rows (Always Visible) */
      .bottom-order-summary .summary-rows {
        display: flex;
        flex-direction: column;
      }

      .bottom-order-summary .summary-row {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: var(--space-base);
        padding: var(--space-small) 0;
      }

      .bottom-order-summary .summary-row:first-child {
        padding-top: 0;
      }

      .bottom-order-summary .summary-row__label {
        font-size: var(--font-size-base);
        color: var(--color-text-secondary);
        flex-shrink: 0;
        min-width: 80px;
      }

      .bottom-order-summary .summary-row__value {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-medium);
        color: var(--color-text-primary);
        text-align: right;
        flex: 1;
        font-variant-numeric: tabular-nums;
      }

      .bottom-order-summary .summary-row__value--muted {
        color: var(--color-text-tertiary);
      }

      /* Discount Row */
      .bottom-order-summary .summary-row--discount {
        display: none;
      }

      .bottom-order-summary .summary-row--discount:not(.hidden) {
        display: flex;
      }

      .bottom-order-summary .summary-row--discount .summary-row__value {
        color: var(--color-accent-primary);
      }

      /* Total Row */
      .bottom-order-summary .summary-row--total {
        padding-top: var(--space-small);
        padding-bottom: 0;
      }

      .bottom-order-summary .summary-row--total .summary-row__label {
        font-weight: var(--font-weight-medium);
        color: var(--color-text-primary);
      }

      /* Submit Button */
      .button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: var(--space-tiny);
        width: 100%;
        height: var(--height-button);
        padding: 0 var(--space-large);
        font-family: inherit;
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-medium);
        letter-spacing: var(--letter-spacing-wider);
        text-transform: uppercase;
        text-decoration: none;
        border: var(--border-subtle) solid transparent;
        border-radius: var(--radius-sm);
        cursor: pointer;
        transition: var(--transition-colors), var(--transition-transform);
        -webkit-tap-highlight-color: transparent;
        user-select: none;
      }

      .button:active {
        transform: scale(0.98);
      }

      .button:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }

      /* Primary Button */
      .button--primary {
        background: var(--color-accent-primary);
        color: var(--color-text-inverse);
        border-color: var(--color-accent-primary);
      }

      .button--primary:hover:not(:disabled) {
        background: var(--color-interactive-hover);
        border-color: var(--color-interactive-hover);
      }

      .button--primary:active:not(:disabled) {
        background: var(--color-interactive-pressed);
        border-color: var(--color-interactive-pressed);
      }

      .checkout-actions {
        display: flex;
        flex-direction: column;
        gap: var(--space-large);
        margin-top: calc(-1 * var(--space-tiny));
      }

      .checkout-actions__legal {
        font-size: var(--font-size-sm);
        line-height: var(--line-height-normal);
        color: var(--color-text-tertiary);
        text-align: left;
        margin: 0;
      }

      .checkout-actions__legal a {
        color: var(--color-text-tertiary);
        text-decoration: underline;
        text-underline-offset: 2px;
      }

      /* Buyer Protection Message */
      .buyer-protection-message {
        padding: var(--space-base);
        background: var(--color-background);
        border-radius: var(--radius-base);
        display: flex;
        flex-direction: column;
        gap: var(--space-small);
      }

      .buyer-protection-message__title {
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-medium);
        letter-spacing: var(--letter-spacing-widest);
        color: var(--color-text-secondary);
        text-transform: uppercase;
        margin: 0;
      }

      .buyer-protection-message__text {
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-regular);
        line-height: var(--line-height-normal);
        color: var(--color-text-primary);
        margin: 0;
      }

      .buyer-protection-message__link {
        color: var(--color-accent-primary);
        text-decoration: underline;
        text-underline-offset: 2px;
        font-weight: var(--font-weight-medium);
      }

      /* Footer Links - Outside content wrapper */
      .bottom-order-summary .footer__links {
        border-top: var(--border-thin) solid var(--color-border-medium);
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: center;
        gap: var(--space-base);
        padding: var(--space-large);
      }

      .bottom-order-summary .footer__links a {
        font-size: var(--font-size-sm);
        color: var(--color-text-tertiary);
        text-decoration: underline;
        text-underline-offset: 2px;
        transition: var(--transition-colors);
      }

      .bottom-order-summary .footer__links a:hover {
        color: var(--color-text-secondary);
      }

      .bottom-order-summary .footer__links a:active {
        color: var(--color-text-primary);
      }

      /* footer__copyright */
      .bottom-order-summary .footer__copyright {
        font-size: var(--font-size-sm);
        font-weight: 400;
        letter-spacing: 0.2px;
        line-height: 18px;
        color: var(--color-text-tertiary);
        text-align: center;
        padding: 0 var(--space-large) var(--space-large);
      }
      /* ===== Select Modal ===== */
      .select-modal {
        position: fixed;
        inset: 0;
        z-index: var(--z-modal);
        pointer-events: none;
      }

      .select-modal.active {
        pointer-events: auto;
      }

      .select-modal__backdrop {
        position: fixed;
        inset: 0;
        background: var(--color-overlay-heavy);
        opacity: 0;
        transition: opacity 0.25s ease;
      }

      .select-modal.active .select-modal__backdrop {
        opacity: 1;
      }

      .select-modal__container {
        position: fixed;
        left: 0;
        right: 0;
        bottom: 0;
        display: flex;
        justify-content: flex-end;
        flex-direction: column;
        max-width: 480px;
        margin: 0 auto;
        transform: translateY(100%);
        transition: transform 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .select-modal.active .select-modal__container {
        transform: translateY(0);
      }

      .select-modal__sheet {
        background: var(--color-canvas);
        border: var(--border-thin) solid var(--color-border-light);
        border-top-left-radius: var(--radius-xlarge);
        border-top-right-radius: var(--radius-xlarge);
        overflow: hidden;
        max-height: 85vh;
        max-height: 85dvh;
        display: flex;
        flex-direction: column;
        padding-bottom: var(--safe-bottom);
        box-shadow: 0 -8px 40px rgba(77, 63, 51, 0.3);
      }

      /* ===== Modal Header ===== */
      .select-modal__header {
        display: grid;
        grid-template-columns: 40px 1fr 40px;
        align-items: center;
        min-height: var(--height-modal-header);
        padding: var(--space-large);
        border-bottom: var(--border-thin) solid var(--color-border-light);
        background: var(--color-canvas);
        flex-shrink: 0;
      }

      .select-modal__header-left {
        justify-self: start;
      }

      .select-modal__header-center {
        justify-self: center;
        text-align: center;
      }

      .select-modal__header-title {
        font-size: var(--font-size-modal-header);
        font-weight: 500;
        letter-spacing: 0.8px;
        line-height: 22px;
        text-transform: uppercase;
        color: var(--color-text-primary);
        margin: 0;
      }

      .select-modal__header-right {
        justify-self: end;
      }

      .select-modal__close {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        background: transparent;
        border: 0;
        padding: 0;
        cursor: pointer;
        color: var(--color-text-tertiary);
        border-radius: var(--radius-small);
      }

      .select-modal__close i {
        font-size: var(--icon-size-default);
        line-height: 1;
      }

      .select-modal__close:hover {
        background: var(--color-overlay-light);
      }

      .select-modal__close:active {
        background: var(--color-overlay-pressed);
      }

      /* ===== Modal Body ===== */
      .select-modal__body {
        padding: var(--space-large);
        background: var(--color-canvas);
        overflow-y: auto;
        flex: 1;
        -webkit-overflow-scrolling: touch;
      }

      .select-modal__list {
        display: flex;
        flex-direction: column;
        gap: 0;
      }

      /* ===== Select List Item ===== */
      .select-list-item {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        padding: var(--space-base);
        min-height: var(--height-list-item-compact);
        background: transparent;
        border: 0;
        cursor: pointer;
        -webkit-tap-highlight-color: transparent;
        width: 100%;
      }

      .select-list-item:active {
        opacity: 0.8;
      }

      .select-list-item__label {
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-medium);
        color: var(--color-text-secondary);
        margin-right: var(--space-base);
        flex: 1;
        text-align: left;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .select-list-item__dot {
        width: var(--height-dot-medium);
        height: var(--height-dot-medium);
        border-radius: var(--radius-round);
        background: var(--color-accent-primary);
        flex-shrink: 0;
        display: none;
      }

      .select-list-item.selected .select-list-item__dot {
        display: block;
      }

      .select-list-item.selected .select-list-item__label {
        color: var(--color-text-primary);
      }

      /* ===== Modal Footer ===== */
      .select-modal__footer {
        border-top: var(--border-thin) solid var(--color-border-light);
        background: var(--color-canvas);
        min-height: var(--height-modal-footer);
        padding: var(--space-large);
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .select-modal__footer:empty {
        padding: 0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header class="header">
        <div class="header__left">
          <button class="icon-button" aria-label="Go back" type="button">
            <i class="ph ph-regular ph-caret-left" aria-hidden="true"></i>
          </button>
        </div>
        <div class="header__center">STÅŒR</div>
        <div class="header__right">
          <button
            class="icon-button icon-button--badge"
            aria-label="Shopping cart"
            data-badge="4"
            type="button"
          >
            <i class="ph ph-regular ph-basket" aria-hidden="true"></i>
          </button>
        </div>
      </header>

      <div class="order-summary">
        <!-- Header -->
        <div class="order-summary__header" onclick="toggleOrderSummary()">
          <div class="order-summary__header-left">
            <h2 class="order-summary__title">Order Summary</h2>
            <i
              class="ph ph-caret-down order-summary__toggle-icon"
              id="toggleIcon"
            ></i>
          </div>
          <span class="order-summary__total" id="headerTotal">$221.00</span>
        </div>

        <!-- Content -->
        <div
          class="order-summary__content"
          id="orderContent"
          style="display: none"
        >
          <!-- Product Items -->
          <div class="order-summary__items">
            <div class="order-item">
              <div class="order-item__image">
                <img
                  src="https://picsum.photos/seed/vintage-denim-jacket-1/200/200"
                  alt="Vintage Denim Jacket"
                />
              </div>
              <div class="order-item__text">
                <div class="order-item__title">Vintage Denim Jacket</div>
                <div class="order-item__subtitle">Like New</div>
              </div>
              <div class="order-item__price">$45.00</div>
            </div>

            <div class="order-item">
              <div class="order-item__image">
                <img
                  src="https://picsum.photos/seed/leather-boots-brown-2/200/200"
                  alt="Leather Ankle Boots"
                />
              </div>
              <div class="order-item__text">
                <div class="order-item__title">Leather Ankle Boots</div>
                <div class="order-item__subtitle">Good</div>
              </div>
              <div class="order-item__price">$62.00</div>
            </div>

            <div class="order-item">
              <div class="order-item__image">
                <img
                  src="https://picsum.photos/seed/silver-chain-necklace-3/200/200"
                  alt="Minimalist Silver Chain Necklace"
                />
              </div>
              <div class="order-item__text">
                <div class="order-item__title">
                  Minimalist Silver Chain Necklace
                </div>
                <div class="order-item__subtitle">New</div>
              </div>
              <div class="order-item__price">$28.00</div>
            </div>

            <div class="order-item">
              <div class="order-item__image">
                <img
                  src="https://picsum.photos/seed/cashmere-scarf-gray-4/200/200"
                  alt="Soft Gray Cashmere Scarf"
                />
              </div>
              <div class="order-item__text">
                <div class="order-item__title">Soft Gray Cashmere Scarf</div>
                <div class="order-item__subtitle">Like New</div>
              </div>
              <div class="order-item__price">$85.00</div>
            </div>
          </div>

          <!-- Discount Code -->
          <div class="discount-code">
            <div class="discount-code__input-row">
              <input
                type="text"
                class="discount-code__input"
                placeholder="Discount code"
                id="discountInput"
              />
              <button class="discount-code__button" id="applyButton" disabled>
                Apply
              </button>
            </div>

            <!-- Error Message -->
            <div class="error-message" id="discountError">
              Hmm, that code doesn't seem to work
            </div>

            <!-- Applied Discount Tag -->
            <div class="applied-discount" id="appliedDiscount">
              <span class="applied-discount__code" id="discountCodeText"
                >SAVE10</span
              >
              <button
                class="applied-discount__remove"
                id="removeButton"
                aria-label="Remove discount"
              >
                <i class="ph ph-x"></i>
              </button>
            </div>
          </div>

          <!-- Summary -->
          <div class="summary-rows">
            <div class="summary-row">
              <span class="summary-row__label">Subtotal</span>
              <span class="summary-row__value">$220.00</span>
            </div>

            <!-- Discount Row (hidden by default) -->
            <div class="summary-row summary-row--discount" id="discountRow">
              <span class="summary-row__label" id="discountLabel"
                >Discount</span
              >
              <span class="summary-row__value" id="discountValue">-$22.00</span>
            </div>

            <div class="summary-row">
              <span class="summary-row__label">Platform Fee</span>
              <span class="summary-row__value">$1.00</span>
            </div>
            <div class="summary-row">
              <span class="summary-row__label">Shipping</span>
              <span class="summary-row__value summary-row__value--muted"
                >Enter shipping address</span
              >
            </div>
            <div class="summary-row summary-row--total">
              <span class="summary-row__label">Total</span>
              <span class="summary-row__value" id="totalValue">$221.00</span>
            </div>
          </div>
        </div>
      </div>

      <div class="contact-section">
        <!-- Section Header -->
        <div class="section-header">
          <h2 class="section-header__title">Contact</h2>
        </div>
        <input
          type="email"
          class="form-input"
          placeholder="Email"
          autocomplete="email"
        />
      </div>

      <div class="delivery-section">
        <!-- Section Header -->
        <div class="section-header">
          <h2 class="section-header__title">Delivery</h2>
        </div>

        <!-- Delivery Method Radio Group -->
        <div class="radio-stack">
          <div class="radio-option">
            <input
              type="radio"
              id="shipping"
              name="delivery-method"
              value="shipping"
              checked
            />
            <label for="shipping" class="radio-option__label">
              <div class="radio-option__radio"></div>
              <div class="radio-option__content">
                <span class="radio-option__title">Shipping</span>
              </div>
              <i class="ph-light ph-package radio-option__icon"></i>
            </label>
          </div>
          <div class="radio-option">
            <input
              type="radio"
              id="pickup"
              name="delivery-method"
              value="pickup"
            />
            <label for="pickup" class="radio-option__label">
              <div class="radio-option__radio"></div>
              <div class="radio-option__content">
                <span class="radio-option__title">Pickup</span>
              </div>
              <i class="ph-light ph-map-pin radio-option__icon"></i>
            </label>
          </div>
        </div>

        <!-- Shipping Forms Wrapper -->
        <div class="shipping-forms-wrapper" id="shippingFormsWrapper">
          <!-- Shipping Address Section -->
          <div class="shipping-section">
            <div class="shipping-section__header-group">
              <h3 class="shipping-section__header">Shipping Address</h3>
              <p class="section-header__subtitle">
                Please ensure your address is correct. We cannot change
                addresses after checkout.
              </p>
            </div>
            <div class="form-fields">
              <!-- First Name -->
              <input
                type="text"
                class="form-input"
                placeholder="First name"
                autocomplete="given-name"
              />

              <!-- Last Name -->
              <input
                type="text"
                class="form-input"
                placeholder="Last name"
                autocomplete="family-name"
              />

              <!-- Address -->
              <div class="form-input-wrapper">
                <input
                  type="text"
                  class="form-input"
                  placeholder="Address"
                  autocomplete="street-address"
                />
                <i class="ph-light ph-magnifying-glass form-input-icon"></i>
              </div>

              <!-- Apartment -->
              <input
                type="text"
                class="form-input"
                placeholder="Apartment, suite, etc. (optional)"
                autocomplete="address-line2"
              />

              <!-- City -->
              <input
                type="text"
                class="form-input"
                placeholder="City"
                autocomplete="address-level2"
              />

              <!-- State -->
              <div
                class="form-select"
                onclick="openStateModal('shippingStateText')"
                style="cursor: pointer"
              >
                <div
                  class="form-select-text placeholder"
                  id="shippingStateText"
                >
                  State
                </div>
                <i class="ph-light ph-caret-down form-select-icon"></i>
              </div>

              <!-- ZIP Code -->
              <input
                type="text"
                class="form-input"
                id="zipCodeInput"
                placeholder="ZIP code"
                autocomplete="postal-code"
              />

              <!-- Phone -->
              <div class="form-input-wrapper">
                <input
                  type="tel"
                  class="form-input"
                  placeholder="Phone"
                  autocomplete="tel"
                />
                <i
                  class="ph-light ph-question form-input-icon form-input-icon--help"
                  id="phoneHelpIcon"
                  tabindex="0"
                  aria-label="Phone number help"
                ></i>
                <div class="tooltip" id="phoneTooltip">
                  In case the seller needs to contact you about your order.
                </div>
              </div>
            </div>
          </div>

          <!-- Shipping Method Section -->
          <div class="shipping-section">
            <div class="shipping-section__header-group">
              <h3 class="shipping-section__header">Shipping Method</h3>
              <p class="shipping-section__subtext" id="shippingSubtext" hidden>
                All shipping rates at actual cost.
              </p>
            </div>

            <div class="helper-message" id="helperMessage">
              Enter your shipping address to view available shipping methods
            </div>

            <!-- Shipping Options (like pickup-locations) -->
            <div class="shipping-options" id="shippingOptions" hidden>
              <!-- Curated Top 3 -->
              <div class="shipping-option">
                <input
                  type="radio"
                  id="standard"
                  name="shipping-method"
                  value="standard"
                  checked
                />
                <label for="standard" class="shipping-option__label">
                  <div class="shipping-option__radio"></div>
                  <div class="shipping-option__content">
                    <span class="shipping-option__title">Standard</span>
                    <span class="shipping-option__detail"
                      >8-11 business days</span
                    >
                  </div>
                  <span class="shipping-option__price">$12.77</span>
                </label>
              </div>
              <div class="shipping-option">
                <input
                  type="radio"
                  id="faster"
                  name="shipping-method"
                  value="faster"
                />
                <label for="faster" class="shipping-option__label">
                  <div class="shipping-option__radio"></div>
                  <div class="shipping-option__content">
                    <span class="shipping-option__title">Faster</span>
                    <span class="shipping-option__detail"
                      >6-7 business days</span
                    >
                  </div>
                  <span class="shipping-option__price">$25.47</span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- Pickup Locations (shown when pickup is selected) -->
        <div
          class="pickup-locations-wrapper"
          id="pickupLocationsWrapper"
          hidden
        >
          <!-- Private Locations Section -->
          <div class="pickup-section">
            <h3 class="pickup-section__header">Private Locations</h3>
            <div class="pickup-locations">
              <div class="pickup-option">
                <input
                  type="radio"
                  id="private-location"
                  name="pickup-location"
                  value="private"
                  checked
                />
                <label for="private-location" class="pickup-option__label">
                  <div class="pickup-option__radio"></div>
                  <div class="pickup-option__content">
                    <span class="pickup-option__title">Seattle, WA 98103</span>
                    <span class="pickup-option__detail"
                      >Exact address provided after purchase</span
                    >
                  </div>
                  <span class="pickup-option__price">FREE</span>
                </label>
              </div>
            </div>
          </div>

          <!-- Public Locations Section -->
          <div class="pickup-section">
            <h3 class="pickup-section__header">Public Locations</h3>
            <div class="pickup-locations">
              <div class="pickup-option">
                <input
                  type="radio"
                  id="public-1"
                  name="pickup-location"
                  value="public-1"
                />
                <label for="public-1" class="pickup-option__label">
                  <div class="pickup-option__radio"></div>
                  <div class="pickup-option__content">
                    <span class="pickup-option__title"
                      >Whole Foods Westlake</span
                    >
                    <span class="pickup-option__detail">1026 NE 64th St</span>
                    <span class="pickup-option__detail">Seattle, WA 98115</span>
                  </div>
                  <span class="pickup-option__price">FREE</span>
                </label>
              </div>
              <div class="pickup-option">
                <input
                  type="radio"
                  id="public-2"
                  name="pickup-location"
                  value="public-2"
                />
                <label for="public-2" class="pickup-option__label">
                  <div class="pickup-option__radio"></div>
                  <div class="pickup-option__content">
                    <span class="pickup-option__title"
                      >Starbucks Capitol Hill</span
                    >
                    <span class="pickup-option__detail">505 E Pike St</span>
                    <span class="pickup-option__detail">Seattle, WA 98122</span>
                  </div>
                  <span class="pickup-option__price">FREE</span>
                </label>
              </div>
            </div>
          </div>

          <!-- Event Locations Section -->
          <div class="pickup-section">
            <h3 class="pickup-section__header">Event Locations</h3>
            <div class="pickup-locations">
              <div class="pickup-option">
                <input
                  type="radio"
                  id="event-1"
                  name="pickup-location"
                  value="event-1"
                />
                <label for="event-1" class="pickup-option__label">
                  <div class="pickup-option__radio"></div>
                  <div class="pickup-option__content">
                    <span class="pickup-option__title"
                      >Fremont Sunday Market</span
                    >
                    <span class="pickup-option__detail"
                      >3401 Evanston Ave N</span
                    >
                    <span class="pickup-option__detail">Seattle, WA 98103</span>
                    <span class="pickup-option__detail"
                      >Dec 22, 2025 Â· 10amâ€“4pm</span
                    >
                  </div>
                  <span class="pickup-option__price">FREE</span>
                </label>
              </div>
              <div class="pickup-option">
                <input
                  type="radio"
                  id="event-2"
                  name="pickup-location"
                  value="event-2"
                />
                <label for="event-2" class="pickup-option__label">
                  <div class="pickup-option__radio"></div>
                  <div class="pickup-option__content">
                    <span class="pickup-option__title"
                      >Fremont Sunday Market</span
                    >
                    <span class="pickup-option__detail"
                      >3401 Evanston Ave N</span
                    >
                    <span class="pickup-option__detail">Seattle, WA 98103</span>
                    <span class="pickup-option__detail"
                      >Dec 29, 2025 Â· 10amâ€“4pm</span
                    >
                  </div>
                  <span class="pickup-option__price">FREE</span>
                </label>
              </div>
              <div class="pickup-option">
                <input
                  type="radio"
                  id="event-3"
                  name="pickup-location"
                  value="event-3"
                />
                <label for="event-3" class="pickup-option__label">
                  <div class="pickup-option__radio"></div>
                  <div class="pickup-option__content">
                    <span class="pickup-option__title"
                      >Capitol Hill Art Walk</span
                    >
                    <span class="pickup-option__detail"
                      >Broadway Ave E & E Pine St</span
                    >
                    <span class="pickup-option__detail">Seattle, WA 98122</span>
                    <span class="pickup-option__detail"
                      >Jan 5, 2026 Â· 6pmâ€“10pm</span
                    >
                  </div>
                  <span class="pickup-option__price">FREE</span>
                </label>
              </div>
              <div class="pickup-option">
                <input
                  type="radio"
                  id="event-4"
                  name="pickup-location"
                  value="event-4"
                />
                <label for="event-4" class="pickup-option__label">
                  <div class="pickup-option__radio"></div>
                  <div class="pickup-option__content">
                    <span class="pickup-option__title"
                      >Pike Place Vintage Fair</span
                    >
                    <span class="pickup-option__detail">85 Pike St</span>
                    <span class="pickup-option__detail">Seattle, WA 98101</span>
                    <span class="pickup-option__detail"
                      >Jan 12â€“14, 2026 Â· 9amâ€“6pm</span
                    >
                  </div>
                  <span class="pickup-option__price">FREE</span>
                </label>
              </div>
              <div class="pickup-option">
                <input
                  type="radio"
                  id="event-5"
                  name="pickup-location"
                  value="event-5"
                />
                <label for="event-5" class="pickup-option__label">
                  <div class="pickup-option__radio"></div>
                  <div class="pickup-option__content">
                    <span class="pickup-option__title"
                      >Ballard Farmers Market</span
                    >
                    <span class="pickup-option__detail"
                      >5300 Ballard Ave NW</span
                    >
                    <span class="pickup-option__detail">Seattle, WA 98107</span>
                    <span class="pickup-option__detail"
                      >Jan 26, 2026 Â· 10amâ€“3pm</span
                    >
                  </div>
                  <span class="pickup-option__price">FREE</span>
                </label>
              </div>
              <div class="pickup-option pickup-option--hidden">
                <input
                  type="radio"
                  id="event-6"
                  name="pickup-location"
                  value="event-6"
                />
                <label for="event-6" class="pickup-option__label">
                  <div class="pickup-option__radio"></div>
                  <div class="pickup-option__content">
                    <span class="pickup-option__title"
                      >Georgetown Art Attack</span
                    >
                    <span class="pickup-option__detail">6206 13th Ave S</span>
                    <span class="pickup-option__detail">Seattle, WA 98108</span>
                    <span class="pickup-option__detail"
                      >Feb 10, 2026 Â· 6pmâ€“10pm</span
                    >
                  </div>
                  <span class="pickup-option__price">FREE</span>
                </label>
              </div>
              <div class="pickup-option pickup-option--hidden">
                <input
                  type="radio"
                  id="event-7"
                  name="pickup-location"
                  value="event-7"
                />
                <label for="event-7" class="pickup-option__label">
                  <div class="pickup-option__radio"></div>
                  <div class="pickup-option__content">
                    <span class="pickup-option__title"
                      >University District Street Fair</span
                    >
                    <span class="pickup-option__detail"
                      >4500 University Way NE</span
                    >
                    <span class="pickup-option__detail">Seattle, WA 98105</span>
                    <span class="pickup-option__detail"
                      >May 18â€“19, 2026 Â· 10amâ€“7pm</span
                    >
                  </div>
                  <span class="pickup-option__price">FREE</span>
                </label>
              </div>
              <div class="pickup-option pickup-option--hidden">
                <input
                  type="radio"
                  id="event-8"
                  name="pickup-location"
                  value="event-8"
                />
                <label for="event-8" class="pickup-option__label">
                  <div class="pickup-option__radio"></div>
                  <div class="pickup-option__content">
                    <span class="pickup-option__title"
                      >Magnolia Summer Fest</span
                    >
                    <span class="pickup-option__detail">3213 W McGraw St</span>
                    <span class="pickup-option__detail">Seattle, WA 98199</span>
                    <span class="pickup-option__detail"
                      >July 27â€“28, 2026 Â· 11amâ€“6pm</span
                    >
                  </div>
                  <span class="pickup-option__price">FREE</span>
                </label>
              </div>
            </div>

            <!-- Show More Button -->
            <button class="show-more-button" id="showMoreEvents">
              Show 3 more events
            </button>
          </div>
        </div>
      </div>

      <!-- Payment Section -->
      <div class="payment-section">
        <!-- Section Header -->
        <div class="section-header section-header--column">
          <h2 class="section-header__title">Payment</h2>
          <p class="section-header__subtitle">
            All transactions are secure and encrypted.
          </p>
        </div>

        <!-- Payment Options Stack -->
        <div class="payment-options">
          <!-- Credit Card Option (with nested form) -->
          <div class="payment-option">
            <input
              type="radio"
              id="credit-card"
              name="payment-method"
              value="credit-card"
              checked
            />
            <div class="payment-option__wrapper">
              <label for="credit-card" class="payment-option__label">
                <div class="payment-option__radio"></div>
                <div class="payment-option__content">
                  <span class="payment-option__title">Credit card</span>
                </div>
              </label>

              <!-- Credit Card Form (shown when credit card selected) -->
              <div class="credit-card-form">
                <!-- Card Number -->
                <div class="form-input-wrapper">
                  <input
                    type="text"
                    class="form-input"
                    placeholder="Card number"
                    autocomplete="cc-number"
                    inputmode="numeric"
                  />
                  <i class="ph-light ph-lock form-input-icon"></i>
                </div>

                <!-- Expiration Date -->
                <div class="form-input-wrapper">
                  <input
                    type="text"
                    class="form-input"
                    placeholder="Expiration date (MM / YY)"
                    autocomplete="cc-exp"
                    inputmode="numeric"
                  />
                </div>

                <!-- Security Code -->
                <div class="form-input-wrapper">
                  <input
                    type="text"
                    class="form-input"
                    placeholder="Security code"
                    autocomplete="cc-csc"
                    inputmode="numeric"
                  />
                  <i
                    class="ph-light ph-question form-input-icon form-input-icon--help"
                    id="securityCodeHelp"
                    tabindex="0"
                    aria-label="Security code help"
                  ></i>
                  <div class="tooltip" id="securityCodeTooltip">
                    3-digit security code usually found on the back of your
                    card. American Express cards have a 4-digit code located on
                    the front.
                  </div>
                </div>

                <!-- Name on Card -->
                <div class="form-input-wrapper">
                  <input
                    type="text"
                    class="form-input"
                    placeholder="Name on card"
                    autocomplete="cc-name"
                  />
                </div>
              </div>
            </div>
          </div>

          <!-- PayPal Option (label + context as siblings, no wrapper) -->
          <div class="payment-option">
            <input
              type="radio"
              id="paypal"
              name="payment-method"
              value="paypal"
            />
            <label for="paypal" class="payment-option__label">
              <div class="payment-option__radio"></div>
              <span class="payment-option__title">PayPal</span>
            </label>

            <!-- PayPal Context (shown when PayPal selected) -->
            <div class="paypal-context">
              <div class="paypal-context__icon">
                <i class="ph-light ph-arrow-square-out"></i>
              </div>
              <p class="paypal-context__text">
                After clicking "Pay with PayPal", you will be redirected to
                PayPal to complete your purchase securely.
              </p>
            </div>
          </div>
        </div>

        <!-- Billing Address Section -->
        <div class="billing-section">
          <div class="section-header section-header--column">
            <h2 class="billing-section__header">Billing Address</h2>
            <p class="section-header__subtitle">
              Select the address that matches your card or payment method.
            </p>
          </div>
          <!-- Billing Options Stack -->
          <div class="billing-options">
            <!-- Same as Shipping Address -->
            <div class="billing-option">
              <input
                type="radio"
                id="billing-same"
                name="billing-address"
                value="same"
                checked
              />
              <label for="billing-same" class="billing-option__label">
                <div class="billing-option__radio"></div>
                <div class="billing-option__content">
                  <span class="billing-option__title"
                    >Same as shipping address</span
                  >
                </div>
              </label>
            </div>

            <!-- Use Different Billing Address -->
            <div class="billing-option">
              <input
                type="radio"
                id="billing-different"
                name="billing-address"
                value="different"
              />
              <div class="billing-option__wrapper">
                <label for="billing-different" class="billing-option__label">
                  <div class="billing-option__radio"></div>
                  <div class="billing-option__content">
                    <span class="billing-option__title"
                      >Use a different billing address</span
                    >
                  </div>
                </label>

                <!-- Billing Address Form (shown when "Use a different billing address" is selected) -->
                <div class="billing-address-form">
                  <div class="form-fields">
                    <!-- First Name -->
                    <input
                      type="text"
                      class="form-input"
                      placeholder="First name"
                      autocomplete="given-name"
                    />

                    <!-- Last Name -->
                    <input
                      type="text"
                      class="form-input"
                      placeholder="Last name"
                      autocomplete="family-name"
                    />

                    <!-- Address -->
                    <div class="form-input-wrapper">
                      <input
                        type="text"
                        class="form-input"
                        placeholder="Address"
                        autocomplete="street-address"
                      />
                      <i
                        class="ph-light ph-magnifying-glass form-input-icon"
                      ></i>
                    </div>

                    <!-- Apartment -->
                    <input
                      type="text"
                      class="form-input"
                      placeholder="Apartment, suite, etc. (optional)"
                      autocomplete="address-line2"
                    />

                    <!-- City -->
                    <input
                      type="text"
                      class="form-input"
                      placeholder="City"
                      autocomplete="address-level2"
                    />

                    <!-- State -->
                    <div
                      class="form-select"
                      onclick="openStateModal('billingStateText')"
                      style="cursor: pointer"
                    >
                      <div
                        class="form-select-text placeholder"
                        id="billingStateText"
                      >
                        State
                      </div>
                      <i class="ph-light ph-caret-down form-select-icon"></i>
                    </div>

                    <!-- ZIP Code -->
                    <input
                      type="text"
                      class="form-input"
                      placeholder="ZIP code"
                      autocomplete="postal-code"
                    />

                    <!-- Phone -->
                    <div class="form-input-wrapper">
                      <input
                        type="tel"
                        class="form-input"
                        placeholder="Phone"
                        autocomplete="tel"
                      />
                      <i
                        class="ph-light ph-question form-input-icon form-input-icon--help"
                        id="billingPhoneHelp"
                        tabindex="0"
                        aria-label="Phone number help"
                      ></i>
                      <div class="tooltip" id="billingPhoneTooltip">
                        In case the seller needs to contact you about your
                        order.
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Bottom Order Summary -->
      <div class="bottom-order-summary">
        <!-- Order Summary Header -->
        <div class="summary-header">
          <h2 class="summary-header__title">Order Summary</h2>
        </div>

        <!-- Content -->
        <div class="summary-content">
          <!-- Product Items (Collapsible) -->
          <div class="product-items" id="productItems">
            <div class="product-item">
              <div class="product-item__image">
                <img
                  src="https://picsum.photos/seed/vintage-denim-jacket-1/200/200"
                  alt="Vintage Denim Jacket"
                />
              </div>
              <div class="product-item__text">
                <div class="product-item__title">Vintage Denim Jacket</div>
                <div class="product-item__subtitle">Like New</div>
              </div>
              <div class="product-item__price">$45.00</div>
            </div>

            <div class="product-item">
              <div class="product-item__image">
                <img
                  src="https://picsum.photos/seed/leather-boots-brown-2/200/200"
                  alt="Leather Ankle Boots"
                />
              </div>
              <div class="product-item__text">
                <div class="product-item__title">Leather Ankle Boots</div>
                <div class="product-item__subtitle">Good</div>
              </div>
              <div class="product-item__price">$62.00</div>
            </div>

            <div class="product-item">
              <div class="product-item__image">
                <img
                  src="https://picsum.photos/seed/silver-chain-necklace-3/200/200"
                  alt="Minimalist Silver Chain Necklace"
                />
              </div>
              <div class="product-item__text">
                <div class="product-item__title">
                  Minimalist Silver Chain Necklace
                </div>
                <div class="product-item__subtitle">New</div>
              </div>
              <div class="product-item__price">$28.00</div>
            </div>

            <div class="product-item">
              <div class="product-item__image">
                <img
                  src="https://picsum.photos/seed/cashmere-scarf-gray-4/200/200"
                  alt="Soft Gray Cashmere Scarf"
                />
              </div>
              <div class="product-item__text">
                <div class="product-item__title">Soft Gray Cashmere Scarf</div>
                <div class="product-item__subtitle">Like New</div>
              </div>
              <div class="product-item__price">$85.00</div>
            </div>
          </div>

          <!-- Discount Code (Always Visible) -->
          <div class="discount-code">
            <div class="discount-code__input-row">
              <input
                type="text"
                class="discount-code__input"
                placeholder="Discount code"
                id="discountInputBottom"
              />
              <button
                class="discount-code__button"
                id="applyButtonBottom"
                disabled
              >
                Apply
              </button>
            </div>

            <!-- Error Message -->
            <div class="error-message" id="discountErrorBottom">
              Hmm, that code doesn't seem to work
            </div>

            <!-- Applied Discount Tag -->
            <div class="applied-discount" id="appliedDiscountBottom">
              <span
                class="applied-discount__code"
                id="discountCodeTextBottom"
              ></span>
              <button
                class="applied-discount__remove"
                id="removeButtonBottom"
                aria-label="Remove discount"
              >
                <i class="ph ph-x"></i>
              </button>
            </div>
          </div>

          <!-- Summary Rows (Always Visible) -->
          <div class="summary-rows">
            <div class="summary-row">
              <span class="summary-row__label">Subtotal</span>
              <span class="summary-row__value">$220.00</span>
            </div>

            <div class="summary-row summary-row--discount hidden">
              <span class="summary-row__label">Discount</span>
              <span class="summary-row__value">-$0.00</span>
            </div>

            <div class="summary-row">
              <span class="summary-row__label">Platform Fee</span>
              <span class="summary-row__value">$1.00</span>
            </div>

            <div class="summary-row summary-row--shipping">
              <span class="summary-row__label">Shipping</span>
              <span class="summary-row__value summary-row__value--muted"
                >Enter shipping address</span
              >
            </div>

            <div class="summary-row summary-row--total">
              <span class="summary-row__label">Total</span>
              <span class="summary-row__value">$221.00</span>
            </div>
          </div>

          <!-- Before You Buy Message -->
          <div class="buyer-protection-message">
            <h3 class="buyer-protection-message__title">Before You Buy</h3>
            <p class="buyer-protection-message__text">
              Sales are final, so
              <a href="tel:+15551234567" class="buyer-protection-message__link"
                >call the seller</a
              >
              if you need to clarify anything. If your item doesn't match the
              description or arrives damaged, contact us within 7 days of
              delivery for a full refund.
            </p>
          </div>

          <!-- Checkout Actions -->
          <div class="checkout-actions">
            <p class="checkout-actions__legal">
              By placing this order, you agree to our
              <a href="#">Terms of Service</a> and
              <a href="#">Privacy Policy</a>.
            </p>
            <!-- Submit Button (Always Visible) -->
            <button class="button button--primary" id="submitButton">
              Complete Purchase
            </button>
          </div>
        </div>

        <!-- Footer Links -->
        <div class="footer__links">
          <a href="#">Privacy Policy</a>
          <a href="#">Terms of Service</a>
        </div>

        <!-- Copyright -->
        <p class="footer__copyright">Â© 2025 STÅŒR</p>
      </div>
    </div>

    <script>
      // ===== CENTRAL STATE =====
      const SUBTOTAL = 220.0;
      const PLATFORM_FEE = 1.0;

      const state = {
        discount: null, // { code, amount }
        shipping: {
          cost: 0,
          method: null,
          isPickup: false,
        },
      };

      // Test discount codes
      const DISCOUNT_CODES = {
        SAVE20: {
          discount: 0.2,
          appliesTo: "all",
        },
        SAVE10: {
          discount: 0.1,
          appliesTo: "all",
        },
        FLAT50: {
          discount: 50.0,
          appliesTo: "all",
        },
        NEWONLY: {
          discount: 0.15,
          appliesTo: "condition",
          condition: "New",
        },
        EXCELLENT25: {
          discount: 0.25,
          appliesTo: "condition",
          condition: "Excellent",
        },
      };

      // Cart items with their conditions
      const CART_ITEMS = [
        { name: "Vintage Denim Jacket", condition: "Like New", price: 45.0 },
        { name: "Leather Ankle Boots", condition: "Good", price: 62.0 },
        {
          name: "Minimalist Silver Chain Necklace",
          condition: "New",
          price: 28.0,
        },
        {
          name: "Soft Gray Cashmere Scarf",
          condition: "Like New",
          price: 85.0,
        },
      ];

      // ===== DOM ELEMENTS =====
      // Top Order Summary
      const topDiscountInput = document.getElementById("discountInput");
      const topApplyButton = document.getElementById("applyButton");
      const topDiscountError = document.getElementById("discountError");
      const topAppliedDiscount = document.getElementById("appliedDiscount");
      const topRemoveButton = document.getElementById("removeButton");
      const topDiscountCodeText = document.getElementById("discountCodeText");
      const topDiscountRow = document.getElementById("discountRow");
      const topDiscountValue = document.getElementById("discountValue");
      const topTotalValue = document.getElementById("totalValue");
      const headerTotal = document.getElementById("headerTotal");

      // Bottom Order Summary
      const bottomDiscountInput = document.getElementById(
        "discountInputBottom"
      );
      const bottomApplyButton = document.getElementById("applyButtonBottom");
      const bottomDiscountError = document.getElementById(
        "discountErrorBottom"
      );
      const bottomAppliedDiscount = document.getElementById(
        "appliedDiscountBottom"
      );
      const bottomRemoveButton = document.getElementById("removeButtonBottom");
      const bottomDiscountCodeText = document.getElementById(
        "discountCodeTextBottom"
      );
      const bottomTotalValue = document.querySelector(
        ".bottom-order-summary .summary-row--total .summary-row__value"
      );
      const bottomShippingValue = document.querySelector(
        ".bottom-order-summary .summary-row--shipping .summary-row__value"
      );
      const bottomDiscountRow = document.querySelector(
        ".bottom-order-summary .summary-row--discount"
      );

      // Top Order Summary - Shipping row
      const topShippingValue = document.querySelector(
        ".order-summary__content .summary-row:nth-child(4) .summary-row__value"
      );

      // Shipping
      const zipCodeInput = document.getElementById("zipCodeInput");
      const helperMessage = document.getElementById("helperMessage");
      const shippingSubtext = document.getElementById("shippingSubtext");
      const shippingOptions = document.getElementById("shippingOptions");

      // Delivery Method
      const shippingFormsWrapper = document.getElementById(
        "shippingFormsWrapper"
      );
      const pickupLocationsWrapper = document.getElementById(
        "pickupLocationsWrapper"
      );
      const shippingRadio = document.getElementById("shipping");
      const pickupRadio = document.getElementById("pickup");

      // ===== CALCULATION FUNCTIONS =====
      function calculateDiscountAmount(discount) {
        if (discount < 1) {
          return SUBTOTAL * discount;
        } else {
          return discount;
        }
      }

      function calculateTotal() {
        const discountAmount = state.discount ? state.discount.amount : 0;
        const shippingCost = state.shipping.cost;
        return SUBTOTAL - discountAmount + PLATFORM_FEE + shippingCost;
      }

      function codeAppliesToCart(codeData) {
        if (codeData.appliesTo === "all") {
          return true;
        }

        if (codeData.appliesTo === "condition") {
          return CART_ITEMS.some(
            (item) => item.condition === codeData.condition
          );
        }

        return false;
      }

      // ===== UPDATE FUNCTIONS =====
      function updateTopSummary() {
        // Update discount
        if (state.discount) {
          topDiscountCodeText.textContent = state.discount.code;
          topAppliedDiscount.classList.add("visible");
          topDiscountValue.textContent = `-$${state.discount.amount.toFixed(
            2
          )}`;
          topDiscountRow.classList.add("visible");
        } else {
          topAppliedDiscount.classList.remove("visible");
          topDiscountRow.classList.remove("visible");
        }

        // Update shipping
        if (state.shipping.isPickup) {
          topShippingValue.textContent = "FREE";
          topShippingValue.classList.remove("summary-row__value--muted");
        } else if (state.shipping.method) {
          topShippingValue.textContent = `$${state.shipping.cost.toFixed(2)}`;
          topShippingValue.classList.remove("summary-row__value--muted");
        } else {
          topShippingValue.textContent = "Enter shipping address";
          topShippingValue.classList.add("summary-row__value--muted");
        }

        // Update total
        const total = calculateTotal();
        topTotalValue.textContent = `$${total.toFixed(2)}`;
        headerTotal.textContent = `$${total.toFixed(2)}`;
      }

      function updateBottomSummary() {
        // Update discount
        if (state.discount) {
          bottomDiscountCodeText.textContent = state.discount.code;
          bottomAppliedDiscount.classList.add("visible");
          const bottomDiscountValue = document.querySelector(
            ".bottom-order-summary .summary-row--discount .summary-row__value"
          );
          bottomDiscountValue.textContent = `-$${state.discount.amount.toFixed(
            2
          )}`;
          bottomDiscountRow.classList.remove("hidden");
        } else {
          bottomAppliedDiscount.classList.remove("visible");
          bottomDiscountRow.classList.add("hidden");
        }

        // Update shipping
        if (state.shipping.isPickup) {
          bottomShippingValue.textContent = "FREE";
          bottomShippingValue.classList.remove("summary-row__value--muted");
        } else if (state.shipping.method) {
          bottomShippingValue.textContent = `$${state.shipping.cost.toFixed(
            2
          )}`;
          bottomShippingValue.classList.remove("summary-row__value--muted");
        } else {
          bottomShippingValue.textContent = "Enter shipping address";
          bottomShippingValue.classList.add("summary-row__value--muted");
        }

        // Update total
        const total = calculateTotal();
        bottomTotalValue.textContent = `$${total.toFixed(2)}`;
      }

      function updateAllSummaries() {
        updateTopSummary();
        updateBottomSummary();
      }

      // ===== DISCOUNT CODE FUNCTIONS =====
      function showError(input, errorElement, message) {
        input.classList.add("error");
        errorElement.textContent = message;
        errorElement.classList.add("visible");
      }

      function clearError(input, errorElement) {
        input.classList.remove("error");
        errorElement.classList.remove("visible");
      }

      function applyDiscount(code, codeData) {
        const discountAmount = calculateDiscountAmount(codeData.discount);
        state.discount = { code, amount: discountAmount };

        // Clear both inputs
        topDiscountInput.value = "";
        bottomDiscountInput.value = "";
        topApplyButton.disabled = true;
        bottomApplyButton.disabled = true;

        // Clear any errors
        clearError(topDiscountInput, topDiscountError);
        clearError(bottomDiscountInput, bottomDiscountError);

        updateAllSummaries();
      }

      function removeDiscount() {
        state.discount = null;
        updateAllSummaries();
      }

      function handleApplyDiscount(input, errorElement) {
        const code = input.value.trim().toUpperCase();

        if (!DISCOUNT_CODES[code]) {
          showError(input, errorElement, "Hmm, that code doesn't seem to work");
          return;
        }

        const codeData = DISCOUNT_CODES[code];

        if (!codeAppliesToCart(codeData)) {
          showError(
            input,
            errorElement,
            "Looks like that code doesn't work for these items"
          );
          return;
        }

        const newDiscountAmount = calculateDiscountAmount(codeData.discount);

        if (state.discount) {
          if (newDiscountAmount <= state.discount.amount) {
            showError(
              input,
              errorElement,
              "Looks like you already have a better discount"
            );
            return;
          }
        }

        clearError(input, errorElement);
        applyDiscount(code, codeData);
      }

      // ===== SHIPPING FUNCTIONS =====
      function updateShippingMethodsVisibility() {
        const hasZipCode = zipCodeInput.value.trim().length > 0;

        if (hasZipCode) {
          helperMessage.hidden = true;
          shippingSubtext.hidden = false;
          shippingOptions.hidden = false;

          // Check if any shipping method is selected
          const shippingRadios = document.querySelectorAll(
            'input[name="shipping-method"]'
          );
          const anyChecked = Array.from(shippingRadios).some(
            (radio) => radio.checked
          );

          if (anyChecked) {
            // Update with the already-selected method
            updateShippingMethod();
          } else if (shippingRadios.length > 0) {
            // Auto-select first method if none selected
            shippingRadios[0].checked = true;
            updateShippingMethod();
          }
        } else {
          helperMessage.hidden = false;
          shippingSubtext.hidden = true;
          shippingOptions.hidden = true;

          // Clear shipping selection
          state.shipping.method = null;
          state.shipping.cost = 0;
          updateAllSummaries();
        }
      }

      function updateShippingMethod() {
        const selectedShipping = document.querySelector(
          'input[name="shipping-method"]:checked'
        );

        if (selectedShipping) {
          const label = document.querySelector(
            `label[for="${selectedShipping.id}"]`
          );
          const priceElement = label.querySelector(".shipping-option__price");
          const priceText = priceElement.textContent.replace("$", "");
          const price = parseFloat(priceText);

          state.shipping.method = selectedShipping.value;
          state.shipping.cost = price;
          state.shipping.isPickup = false;

          updateAllSummaries();
        }
      }

      function updateDeliveryMethod() {
        if (shippingRadio.checked) {
          shippingFormsWrapper.hidden = false;
          pickupLocationsWrapper.hidden = true;
          state.shipping.isPickup = false;

          // Restore shipping cost if method was selected
          const selectedShipping = document.querySelector(
            'input[name="shipping-method"]:checked'
          );
          if (selectedShipping) {
            updateShippingMethod();
          } else {
            state.shipping.cost = 0;
            updateAllSummaries();
          }
        } else if (pickupRadio.checked) {
          shippingFormsWrapper.hidden = true;
          pickupLocationsWrapper.hidden = false;
          state.shipping.isPickup = true;
          state.shipping.cost = 0;
          updateAllSummaries();
        }
      }

      // ===== EVENT LISTENERS =====

      // Top Discount Code
      topDiscountInput.addEventListener("input", function () {
        topApplyButton.disabled = !this.value.trim();
        clearError(topDiscountInput, topDiscountError);
      });

      topApplyButton.addEventListener("click", function () {
        handleApplyDiscount(topDiscountInput, topDiscountError);
      });

      topRemoveButton.addEventListener("click", removeDiscount);

      // Bottom Discount Code
      bottomDiscountInput.addEventListener("input", function () {
        bottomApplyButton.disabled = !this.value.trim();
        clearError(bottomDiscountInput, bottomDiscountError);
      });

      bottomApplyButton.addEventListener("click", function () {
        handleApplyDiscount(bottomDiscountInput, bottomDiscountError);
      });

      bottomRemoveButton.addEventListener("click", removeDiscount);

      // ZIP Code - Shipping Methods Visibility
      zipCodeInput.addEventListener("input", updateShippingMethodsVisibility);

      // Shipping Method Selection
      const shippingRadios = document.querySelectorAll(
        'input[name="shipping-method"]'
      );
      shippingRadios.forEach((radio) => {
        radio.addEventListener("change", updateShippingMethod);
      });

      // Delivery Method Toggle
      shippingRadio.addEventListener("change", updateDeliveryMethod);
      pickupRadio.addEventListener("change", updateDeliveryMethod);

      // ===== ORDER SUMMARY TOGGLE =====
      function toggleOrderSummary() {
        const content = document.getElementById("orderContent");
        const icon = document.getElementById("toggleIcon");

        if (content.style.display === "none") {
          content.style.display = "flex";
          icon.classList.add("expanded");
        } else {
          content.style.display = "none";
          icon.classList.remove("expanded");
        }
      }

      // ===== SELECT PLACEHOLDER HANDLING =====
      const selects = document.querySelectorAll(".form-select select");

      selects.forEach((select) => {
        if (select.value === "" || select.selectedIndex === 0) {
          select.classList.add("placeholder");
        }

        select.addEventListener("change", function () {
          if (this.value === "" || this.selectedIndex === 0) {
            this.classList.add("placeholder");
          } else {
            this.classList.remove("placeholder");
          }
          this.blur();
        });
      });

      // ===== TOOLTIP FUNCTIONALITY =====

      // Phone tooltip (shipping section)
      const phoneHelpIcon = document.getElementById("phoneHelpIcon");
      const phoneTooltip = document.getElementById("phoneTooltip");

      if (phoneHelpIcon && phoneTooltip) {
        let isHovering = false;
        let isClicked = false;

        phoneHelpIcon.addEventListener("mouseenter", function () {
          isHovering = true;
          phoneTooltip.classList.add("tooltip--visible");
        });

        phoneHelpIcon.addEventListener("mouseleave", function () {
          isHovering = false;
          if (!isClicked) {
            phoneTooltip.classList.remove("tooltip--visible");
          }
        });

        phoneHelpIcon.addEventListener("click", function (event) {
          event.stopPropagation();
          isClicked = !isClicked;
          if (isClicked) {
            phoneTooltip.classList.add("tooltip--visible");
          } else {
            phoneTooltip.classList.remove("tooltip--visible");
          }
        });

        document.addEventListener("click", function (event) {
          if (
            !phoneHelpIcon.contains(event.target) &&
            !phoneTooltip.contains(event.target)
          ) {
            isClicked = false;
            if (!isHovering) {
              phoneTooltip.classList.remove("tooltip--visible");
            }
          }
        });
      }

      // Security code tooltip
      const securityCodeHelpIcon = document.getElementById("securityCodeHelp");
      const securityCodeTooltip = document.getElementById(
        "securityCodeTooltip"
      );

      if (securityCodeHelpIcon && securityCodeTooltip) {
        let isHovering = false;
        let isClicked = false;

        securityCodeHelpIcon.addEventListener("mouseenter", function () {
          isHovering = true;
          securityCodeTooltip.classList.add("tooltip--visible");
        });

        securityCodeHelpIcon.addEventListener("mouseleave", function () {
          isHovering = false;
          if (!isClicked) {
            securityCodeTooltip.classList.remove("tooltip--visible");
          }
        });

        securityCodeHelpIcon.addEventListener("click", function (event) {
          event.stopPropagation();
          isClicked = !isClicked;
          if (isClicked) {
            securityCodeTooltip.classList.add("tooltip--visible");
          } else {
            securityCodeTooltip.classList.remove("tooltip--visible");
          }
        });

        document.addEventListener("click", function (event) {
          if (
            !securityCodeHelpIcon.contains(event.target) &&
            !securityCodeTooltip.contains(event.target)
          ) {
            isClicked = false;
            if (!isHovering) {
              securityCodeTooltip.classList.remove("tooltip--visible");
            }
          }
        });
      }

      // Billing phone tooltip
      const billingHelpIcon = document.getElementById("billingPhoneHelp");
      const billingTooltip = document.getElementById("billingPhoneTooltip");

      if (billingHelpIcon && billingTooltip) {
        let isBillingHovering = false;
        let isBillingClicked = false;

        billingHelpIcon.addEventListener("mouseenter", function () {
          isBillingHovering = true;
          billingTooltip.classList.add("tooltip--visible");
        });

        billingHelpIcon.addEventListener("mouseleave", function () {
          isBillingHovering = false;
          if (!isBillingClicked) {
            billingTooltip.classList.remove("tooltip--visible");
          }
        });

        billingHelpIcon.addEventListener("click", function (event) {
          event.stopPropagation();
          isBillingClicked = !isBillingClicked;
          if (isBillingClicked) {
            billingTooltip.classList.add("tooltip--visible");
          } else {
            billingTooltip.classList.remove("tooltip--visible");
          }
        });

        document.addEventListener("click", function (event) {
          if (
            !billingHelpIcon.contains(event.target) &&
            !billingTooltip.contains(event.target)
          ) {
            isBillingClicked = false;
            if (!isBillingHovering) {
              billingTooltip.classList.remove("tooltip--visible");
            }
          }
        });
      }

      // ===== PICKUP SHOW MORE FUNCTIONALITY =====
      const showMoreButton = document.getElementById("showMoreEvents");
      const hiddenEvents = document.querySelectorAll(".pickup-option--hidden");
      const eventLocations = document.querySelector(
        ".pickup-section:last-child .pickup-locations"
      );

      function updateLastVisibleStyling() {
        const allEventOptions =
          eventLocations.querySelectorAll(".pickup-option");
        let lastVisible = null;

        allEventOptions.forEach((option) => {
          if (!option.classList.contains("pickup-option--hidden")) {
            lastVisible = option;
          }
        });

        allEventOptions.forEach((option) => {
          option.classList.remove("last-visible");
        });

        if (lastVisible) {
          lastVisible.classList.add("last-visible");
        }
      }

      updateLastVisibleStyling();

      showMoreButton.addEventListener("click", function () {
        hiddenEvents.forEach((event) => {
          event.classList.remove("pickup-option--hidden");
        });
        showMoreButton.style.display = "none";
        updateLastVisibleStyling();
      });

      // ===== INITIALIZATION =====
      updateDeliveryMethod();
      updateShippingMethodsVisibility();
      updateAllSummaries();

      // ===== PAYMENT METHOD BUTTON TEXT =====
      const submitButton = document.getElementById("submitButton");
      const paymentRadios = document.querySelectorAll(
        'input[name="payment-method"]'
      );

      function updateSubmitButtonText() {
        const selectedPayment = document.querySelector(
          'input[name="payment-method"]:checked'
        );
        if (selectedPayment && selectedPayment.value === "paypal") {
          submitButton.textContent = "Pay with PayPal";
        } else {
          submitButton.textContent = "Complete Purchase";
        }
      }

      paymentRadios.forEach((radio) => {
        radio.addEventListener("change", updateSubmitButtonText);
      });

      // Set initial button text
      updateSubmitButtonText();

      // ===== STATE SELECT MODAL =====
      // US States data
      const states = [
        { id: "AL", name: "Alabama" },
        { id: "AK", name: "Alaska" },
        { id: "AZ", name: "Arizona" },
        { id: "AR", name: "Arkansas" },
        { id: "CA", name: "California" },
        { id: "CO", name: "Colorado" },
        { id: "CT", name: "Connecticut" },
        { id: "DE", name: "Delaware" },
        { id: "FL", name: "Florida" },
        { id: "GA", name: "Georgia" },
        { id: "HI", name: "Hawaii" },
        { id: "ID", name: "Idaho" },
        { id: "IL", name: "Illinois" },
        { id: "IN", name: "Indiana" },
        { id: "IA", name: "Iowa" },
        { id: "KS", name: "Kansas" },
        { id: "KY", name: "Kentucky" },
        { id: "LA", name: "Louisiana" },
        { id: "ME", name: "Maine" },
        { id: "MD", name: "Maryland" },
        { id: "MA", name: "Massachusetts" },
        { id: "MI", name: "Michigan" },
        { id: "MN", name: "Minnesota" },
        { id: "MS", name: "Mississippi" },
        { id: "MO", name: "Missouri" },
        { id: "MT", name: "Montana" },
        { id: "NE", name: "Nebraska" },
        { id: "NV", name: "Nevada" },
        { id: "NH", name: "New Hampshire" },
        { id: "NJ", name: "New Jersey" },
        { id: "NM", name: "New Mexico" },
        { id: "NY", name: "New York" },
        { id: "NC", name: "North Carolina" },
        { id: "ND", name: "North Dakota" },
        { id: "OH", name: "Ohio" },
        { id: "OK", name: "Oklahoma" },
        { id: "OR", name: "Oregon" },
        { id: "PA", name: "Pennsylvania" },
        { id: "RI", name: "Rhode Island" },
        { id: "SC", name: "South Carolina" },
        { id: "SD", name: "South Dakota" },
        { id: "TN", name: "Tennessee" },
        { id: "TX", name: "Texas" },
        { id: "UT", name: "Utah" },
        { id: "VT", name: "Vermont" },
        { id: "VA", name: "Virginia" },
        { id: "WA", name: "Washington" },
        { id: "WV", name: "West Virginia" },
        { id: "WI", name: "Wisconsin" },
        { id: "WY", name: "Wyoming" },
      ];

      let shippingState = null;
      let billingState = null;
      let currentStateField = null; // Track which field opened the modal

      function renderStateList() {
        const listContainer = document.getElementById("stateList");
        // Get the current selection for the field that opened the modal
        const currentSelection =
          currentStateField === "shippingStateText"
            ? shippingState
            : billingState;

        listContainer.innerHTML = states
          .map((state) => {
            const isSelected =
              currentSelection && currentSelection.id === state.id;
            return `
            <button class="select-list-item ${isSelected ? "selected" : ""}" 
                    onclick="selectState('${state.id}')"
                    type="button">
              <span class="select-list-item__label">${state.name}</span>
              <div class="select-list-item__dot"></div>
            </button>
          `;
          })
          .join("");
      }

      function selectState(stateId) {
        const state = states.find((s) => s.id === stateId);

        // Save to the appropriate state variable
        if (currentStateField === "shippingStateText") {
          shippingState = state;
        } else if (currentStateField === "billingStateText") {
          billingState = state;
        }

        // Only update the field that opened the modal
        if (currentStateField) {
          const displayElement = document.getElementById(currentStateField);
          if (displayElement) {
            displayElement.textContent = state.name;
            displayElement.classList.remove("placeholder");
          }
        }

        // Close modal
        closeStateModal();
      }

      function openStateModal(fieldId) {
        currentStateField = fieldId;
        const modal = document.getElementById("stateModal");
        renderStateList();
        modal.classList.add("active");
        document.body.style.overflow = "hidden";
      }

      function closeStateModal() {
        const modal = document.getElementById("stateModal");
        const modalBody = modal.querySelector(".select-modal__body");

        modal.classList.remove("active");
        document.body.style.overflow = "";

        // Reset scroll position after modal closes
        setTimeout(() => {
          if (modalBody) {
            modalBody.scrollTop = 0;
          }
        }, 250); // Wait for animation to complete
      }
    </script>
    <!-- Select Modal -->
    <div class="select-modal" id="stateModal">
      <div class="select-modal__backdrop" onclick="closeStateModal()"></div>
      <div class="select-modal__container">
        <div class="select-modal__sheet">
          <div class="select-modal__header">
            <div class="select-modal__header-left"></div>
            <div class="select-modal__header-center">
              <h2 class="select-modal__header-title">Select State</h2>
            </div>
            <div class="select-modal__header-right">
              <button
                class="select-modal__close"
                onclick="closeStateModal()"
                aria-label="Close"
              >
                <i class="ph ph-light ph-x"></i>
              </button>
            </div>
          </div>
          <div class="select-modal__body">
            <div class="select-modal__list" id="stateList">
              <!-- Items will be dynamically inserted here -->
            </div>
          </div>
          <div class="select-modal__footer" id="stateFooter">
            <!-- Footer stays empty, no clear button -->
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
